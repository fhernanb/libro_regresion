<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Selección de variables | Modelos de Regresión con R</title>
  <meta name="description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Selección de variables | Modelos de Regresión con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="github-repo" content="fhernanb/libro_regresion" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Selección de variables | Modelos de Regresión con R" />
  
  <meta name="twitter:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Freddy Hernández" />
<meta name="author" content="Olga Usuga" />
<meta name="author" content="Mauricio Mazo" />


<meta name="date" content="2024-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="allpossibleregre.html"/>
<link rel="next" href="feature_selec.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos de Regresión con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>1</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#modelo-estadístico"><i class="fa fa-check"></i>Modelo estadístico</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#función-lm"><i class="fa fa-check"></i>Función <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#clase-lm"><i class="fa fa-check"></i>Clase <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#mínimos-cuadrados-ponderados"><i class="fa fa-check"></i>Mínimos cuadrados ponderados</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#apéndice"><i class="fa fa-check"></i>Apéndice</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-mínimos-cuadrados"><i class="fa fa-check"></i>Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Estimación por máxima verosimilitud</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="trans.html"><a href="trans.html"><i class="fa fa-check"></i><b>2</b> Transformaciones</a>
<ul>
<li class="chapter" data-level="" data-path="trans.html"><a href="trans.html#transformaciones-para-linealizar-el-modelo"><i class="fa fa-check"></i>Transformaciones para linealizar el modelo</a>
<ul>
<li class="chapter" data-level="" data-path="trans.html"><a href="trans.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>3</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#modelo-estadístico-1"><i class="fa fa-check"></i>Modelo estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="predict.html"><a href="predict.html"><i class="fa fa-check"></i><b>4</b> Predicción</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#función-predict"><i class="fa fa-check"></i>Función <code>predict</code></a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-respuesta-media-eyx_0"><i class="fa fa-check"></i>Intervalo de confianza para la respuesta media <span class="math inline">\(E(Y|x_0)\)</span></a></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-predicción-de-nuevas-observaciones"><i class="fa fa-check"></i>Intervalo de confianza para la predicción de nuevas observaciones</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simul.html"><a href="simul.html"><i class="fa fa-check"></i><b>5</b> Simulación</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#preguntas-sobre-simulación-en-stackoverflow"><i class="fa fa-check"></i>Preguntas sobre simulación en StackOverFlow</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#simulando-datos-de-un-modelo-lineal"><i class="fa fa-check"></i>Simulando datos de un modelo lineal</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#función-simulate"><i class="fa fa-check"></i>Función <code>simulate</code></a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#otras-herramientas-para-simular"><i class="fa fa-check"></i>Otras herramientas para simular</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#videos-sugeridos"><i class="fa fa-check"></i>Videos sugeridos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ic.html"><a href="ic.html"><i class="fa fa-check"></i><b>6</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint"><i class="fa fa-check"></i>Función <code>confint</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint_sigma2"><i class="fa fa-check"></i>Función <code>confint_sigma2</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-10"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="varcuali.html"><a href="varcuali.html"><i class="fa fa-check"></i><b>7</b> Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#es-posible-incluir-variables-cualitativas"><i class="fa fa-check"></i>¿Es posible incluir variables cualitativas?</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#variable-indicadora-dummy-ficticia-o-binaria"><i class="fa fa-check"></i>Variable indicadora, dummy, ficticia o binaria</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#creando-variables-indicadoras"><i class="fa fa-check"></i>Creando variables indicadoras</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-11"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#modelos-con-variables-cualitativas"><i class="fa fa-check"></i>Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#significancia-de-variables-cualitativas"><i class="fa fa-check"></i>Significancia de variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-13"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ph1.html"><a href="ph1.html"><i class="fa fa-check"></i><b>8</b> Pruebas de hipótesis parte I</a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#pruebas-sobre-los-coeficientes-beta"><i class="fa fa-check"></i>Pruebas sobre los coeficientes <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-summary-cuando-beta_j0-0"><i class="fa fa-check"></i>Función <code>summary</code> cuando <span class="math inline">\(\beta_{j0} = 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-beta_test-cuando-beta_k0-neq-0"><i class="fa fa-check"></i>Función <code>beta_test</code> cuando <span class="math inline">\(\beta_{k0} \neq 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ph2.html"><a href="ph2.html"><i class="fa fa-check"></i><b>9</b> Pruebas de hipótesis parte II</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-sobre-todos-los-coeficientes"><i class="fa fa-check"></i>Prueba sobre todos los coeficientes</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-para-rls"><i class="fa fa-check"></i>Ejemplo para RLS</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-para-rlm"><i class="fa fa-check"></i>Ejemplo para RLM</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-para-comparar-modelos-anidados"><i class="fa fa-check"></i>Prueba para comparar modelos anidados</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-17"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#función-anova"><i class="fa fa-check"></i>Función <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#summary-versus-anova"><i class="fa fa-check"></i><code>summary</code> versus <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-20"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i>Prueba razón de verosimilitud</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-21"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#comparaciones-múltiples"><i class="fa fa-check"></i>Comparaciones múltiples</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-22"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diag1.html"><a href="diag1.html"><i class="fa fa-check"></i><b>10</b> Diagnósticos parte I</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#supuestos"><i class="fa fa-check"></i>Supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#residuales"><i class="fa fa-check"></i>Residuales</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-23"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-normalidad-de-los-errores"><i class="fa fa-check"></i>Chequeando normalidad de los errores</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-con-media-cero"><i class="fa fa-check"></i>Chequeando si errores con media cero</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-los-errores-tiene-varianza-constante"><i class="fa fa-check"></i>Chequeando si los errores tiene varianza constante</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-no-están-correlacionados"><i class="fa fa-check"></i>Chequeando si errores no están correlacionados</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-cumpliendo-los-supuestos"><i class="fa fa-check"></i>Ejemplo cumpliendo los supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-violando-los-supuestos"><i class="fa fa-check"></i>Ejemplo violando los supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-violando-los-supuestos-1"><i class="fa fa-check"></i>Ejemplo violando los supuestos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#gráficos-de-residuales-usando-car"><i class="fa fa-check"></i>Gráficos de residuales usando car</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#prueba-de-falta-de-ajuste"><i class="fa fa-check"></i>Prueba de falta de ajuste</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-1-1"><i class="fa fa-check"></i>Ejemplo 1</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-2-1"><i class="fa fa-check"></i>Ejemplo 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="diag2.html"><a href="diag2.html"><i class="fa fa-check"></i><b>11</b> Diagnósticos parte II</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#matriz-sombrero-o-hat"><i class="fa fa-check"></i>Matriz sombrero o hat</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#qué-es-extrapolación-oculta"><i class="fa fa-check"></i>¿Qué es extrapolación oculta?</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-25"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#reto-para-el-lector"><i class="fa fa-check"></i>Reto para el lector</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#punto-de-balanceo"><i class="fa fa-check"></i>Punto de balanceo</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#punto-atípico-outlier-y-punto-influyente"><i class="fa fa-check"></i>Punto atípico (outlier) y punto influyente</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#uso-de-los-residuales-para-detectar-atípicos-outliers"><i class="fa fa-check"></i>Uso de los residuales para detectar atípicos (outliers)</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#prueba-de-bonferroni-para-detectar-atípicos-outliers"><i class="fa fa-check"></i>Prueba de Bonferroni para detectar atípicos (outliers)</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-26"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#distancia-de-cook"><i class="fa fa-check"></i>Distancia de Cook</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-27"><i class="fa fa-check"></i>Ejemplo:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dffits"><i class="fa fa-check"></i>DFFITS</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dfbetas"><i class="fa fa-check"></i>DFBETAS</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-28"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#estadística-press-y-r2-de-predicción"><i class="fa fa-check"></i>Estadística PRESS y <span class="math inline">\(R^2\)</span> de predicción</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-29"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#valores-de-corte-para-diagnósticos"><i class="fa fa-check"></i>Valores de corte para diagnósticos</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="homo.html"><a href="homo.html"><i class="fa fa-check"></i><b>12</b> Pruebas de Homocedasticidad</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#breusch-pagan-test"><i class="fa fa-check"></i>Breusch-Pagan Test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-30"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#white-test"><i class="fa fa-check"></i>White test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-31"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#score-test-for-nonconstant-error-variance"><i class="fa fa-check"></i>Score test for nonconstant error variance</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#goldfeld-quandt-test"><i class="fa fa-check"></i>Goldfeld-Quandt Test</a></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#harrison-mccabe-test"><i class="fa fa-check"></i>Harrison-McCabe test</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="indep.html"><a href="indep.html"><i class="fa fa-check"></i><b>13</b> Pruebas de independencia de los errores</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#durbin-watson-test"><i class="fa fa-check"></i>Durbin-Watson test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#breusch-godfrey-test"><i class="fa fa-check"></i>Breusch-Godfrey Test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod_poli.html"><a href="mod_poli.html"><i class="fa fa-check"></i><b>14</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-de-una-o-varias-variables"><i class="fa fa-check"></i>Modelos polinomiales de una o varias variables</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#funciones-i-y-poly"><i class="fa fa-check"></i>Funciones <code>I()</code> y <code>poly()</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-con-splines"><i class="fa fa-check"></i>Modelos polinomiales con splines</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-36"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-bs"><i class="fa fa-check"></i>Función <code>bs</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-37"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-38"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-lowess"><i class="fa fa-check"></i>Función <code>lowess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-39"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-loess"><i class="fa fa-check"></i>Función <code>loess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-40"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#optimización-con-superficies-de-respuesta"><i class="fa fa-check"></i>Optimización con superficies de respuesta</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-nlminb"><i class="fa fa-check"></i>Función <code>nlminb</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-41"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#polinomios-ortogonales"><i class="fa fa-check"></i>Polinomios ortogonales</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="allpossibleregre.html"><a href="allpossibleregre.html"><i class="fa fa-check"></i><b>15</b> Todas las regresiones posibles</a>
<ul>
<li class="chapter" data-level="" data-path="allpossibleregre.html"><a href="allpossibleregre.html#criterios-para-elegir-modelos"><i class="fa fa-check"></i>Criterios para elegir modelos</a></li>
<li class="chapter" data-level="" data-path="allpossibleregre.html"><a href="allpossibleregre.html#paquete-olsrr"><i class="fa fa-check"></i>Paquete <strong>olsrr</strong></a>
<ul>
<li class="chapter" data-level="" data-path="allpossibleregre.html"><a href="allpossibleregre.html#ejemplo-42"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="allpossibleregre.html"><a href="allpossibleregre.html#ejemplo-43"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="allpossibleregre.html"><a href="allpossibleregre.html#ejemplo-44"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="selec.html"><a href="selec.html"><i class="fa fa-check"></i><b>16</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#akaike-information-criterion-aic"><i class="fa fa-check"></i>Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-loglik-y-aic"><i class="fa fa-check"></i>Funciones <code>logLik</code> y <code>AIC</code></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#métodos"><i class="fa fa-check"></i>Métodos</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#función-stepaic"><i class="fa fa-check"></i>Función <code>stepAIC</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-45"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-backward"><i class="fa fa-check"></i>Aplicación del método <strong>backward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-forward"><i class="fa fa-check"></i>Aplicación del método <strong>forward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-both"><i class="fa fa-check"></i>Aplicación del método <strong>both</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-addterm-y-dropterm"><i class="fa fa-check"></i>Funciones <code>addterm</code> y <code>dropterm</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-46"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-mixlm"><i class="fa fa-check"></i>Paquete <strong>mixlm</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-47"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-leaps"><i class="fa fa-check"></i>Paquete <strong>leaps</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-48"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-para-el-curso-estadística-ii"><i class="fa fa-check"></i>Funciones para el curso Estadística II</a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-49"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="feature_selec.html"><a href="feature_selec.html"><i class="fa fa-check"></i><b>17</b> Feature selection</a>
<ul>
<li class="chapter" data-level="" data-path="feature_selec.html"><a href="feature_selec.html#feature-selection-with-the-caret-r-package"><i class="fa fa-check"></i>Feature Selection with the Caret R Package</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multicoli.html"><a href="multicoli.html"><i class="fa fa-check"></i><b>18</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#qué-es-multicolinealidad"><i class="fa fa-check"></i>¿Qué es multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#multicolinealidad-inducida"><i class="fa fa-check"></i>Multicolinealidad inducida</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#cómo-identificar-la-multicolinealidad"><i class="fa fa-check"></i>¿Cómo identificar la multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#matriz-de-correlaciones"><i class="fa fa-check"></i>Matriz de correlaciones</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-50"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#factor-de-inflación-de-la-varianza-vif"><i class="fa fa-check"></i>Factor de Inflación de la Varianza (VIF)</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-51"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#análisis-de-los-valores-propios-de-mathbfxtopmathbfx"><i class="fa fa-check"></i>Análisis de los valores propios de <span class="math inline">\(\mathbf{X}^\top\mathbf{X}\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#número-de-condición"><i class="fa fa-check"></i>Número de condición</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-52"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#índice-de-condición"><i class="fa fa-check"></i>Índice de condición</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-53"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="coefstand.html"><a href="coefstand.html"><i class="fa fa-check"></i><b>19</b> Regresión con coeficientes de regresión estandarizados</a>
<ul>
<li class="chapter" data-level="" data-path="coefstand.html"><a href="coefstand.html#ejemplo-54"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="algmat.html"><a href="algmat.html"><i class="fa fa-check"></i><b>20</b> Algebra matricial con R</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#matrices"><i class="fa fa-check"></i>Matrices</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-55"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#operaciones-básicas-sobre-una-matriz"><i class="fa fa-check"></i>Operaciones básicas sobre una matriz</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#rango-de-una-matriz"><i class="fa fa-check"></i>Rango de una matriz</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-56"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-57"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="WilRog.html"><a href="WilRog.html"><i class="fa fa-check"></i><b>21</b> Notación de Wilkinson y Rogers</a>
<ul>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#qué-es-una-fórmula-en-r"><i class="fa fa-check"></i>¿Qué es una fórmula en R?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#para-qué-sirve-la-notación-de-wilkinson-y-rogers"><i class="fa fa-check"></i>¿Para qué sirve la notación de Wilkinson y Rogers?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#paquete-formula-de-r"><i class="fa fa-check"></i>Paquete Formula de R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="xy.html"><a href="xy.html"><i class="fa fa-check"></i><b>22</b> ¿Cómo obtener la matriz <span class="math inline">\(\boldsymbol{X}\)</span> y el vector <span class="math inline">\(\boldsymbol{y}\)</span>?</a>
<ul>
<li class="chapter" data-level="" data-path="xy.html"><a href="xy.html#ejemplo-58"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="important.html"><a href="important.html"><i class="fa fa-check"></i><b>23</b> Otros aspectos importantes</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#qué-otras-funciones-hay-en-r-para-ajustar-un-modelo"><i class="fa fa-check"></i>¿Qué otras funciones hay en R para ajustar un modelo?</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#ejemplo-59"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#modelos-de-regresión-con-grandes-conjuntos-de-datos"><i class="fa fa-check"></i>Modelos de regresión con grandes conjuntos de datos</a></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#fast-lm-in-r"><i class="fa fa-check"></i>Fast <code>lm</code> in R</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pasos.html"><a href="pasos.html"><i class="fa fa-check"></i><b>24</b> Pasos para construir modelos</a>
<ul>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-construir-un-modelo"><i class="fa fa-check"></i>Pasos para construir UN modelo</a></li>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-comparar-varios-modelos"><i class="fa fa-check"></i>Pasos para comparar varios modelos</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="misspecification.html"><a href="misspecification.html"><i class="fa fa-check"></i><b>25</b> Mala especificación</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="selec" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">16</span> Selección de variables<a href="selec.html#selec" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En este capítulo se muestra como realizar selección de variables en un modelo de regresión lineal.</p>
<div id="akaike-information-criterion-aic" class="section level2 unnumbered hasAnchor">
<h2>Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)<a href="selec.html#akaike-information-criterion-aic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El <span class="math inline">\(AIC\)</span> se define como:</p>
<p><span class="math display">\[AIC = - 2 \times logLik + k \times n_{par},\]</span></p>
<p>donde <span class="math inline">\(logLik\)</span> corresponde al valor de log-verosimilitud del modelo para el vector de parámetros <span class="math inline">\(\hat{\Theta}\)</span>, <span class="math inline">\(k\)</span> es un valor de penalización por el exceso de parámetros y <span class="math inline">\(n_{par}\)</span> corresponde al número de parámetros del modelo.</p>
<p>Se debe recordar siempre que:</p>
<ul>
<li>El mejor modelo es aquel que <span class="math inline">\(logLik\)</span> ↑.</li>
<li>El mejor modelo es aquel que <span class="math inline">\(AIC\)</span> ↓.</li>
</ul>
<p>Cuando el valor de penalización <span class="math inline">\(k=\log(n)\)</span> entonces el <span class="math inline">\(AIC\)</span> se llamada en <span class="math inline">\(BIC\)</span> o <span class="math inline">\(SBC\)</span> (Schwarz’s Bayesian criterion).</p>
</div>
<div id="funciones-loglik-y-aic" class="section level2 unnumbered hasAnchor">
<h2>Funciones <code>logLik</code> y <code>AIC</code><a href="selec.html#funciones-loglik-y-aic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>logLik</code> sirve para obtener el valor de log-verosimilitud de un modelo y la función <code>AIC</code> entrega el Akaike Information Criterion. La estructura de ambas funciones se muestra a continuación.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="selec.html#cb343-1" tabindex="-1"></a><span class="fu">logLik</span>(object)</span>
<span id="cb343-2"><a href="selec.html#cb343-2" tabindex="-1"></a><span class="fu">AIC</span>(object, <span class="at">k=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="métodos" class="section level2 unnumbered hasAnchor">
<h2>Métodos<a href="selec.html#métodos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los métodos para realizar selcción de variables se pueden clasificar de la siguiente manera:</p>
<ol style="list-style-type: decimal">
<li>Todas las regresiones posibles.</li>
<li>Selección de variables.
<ul>
<li>Forward</li>
<li>Backward</li>
</ul></li>
</ol>
<p>A continuación una imagen ilustrativa para entender ambos métodos.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:selection01"></span>
<img src="images/forward_backward.png" alt="Ilustración de los métodos." width="686" />
<p class="caption">
Figure 16.1: Ilustración de los métodos.
</p>
</div>
<ul>
<li>Un término ingresa al modelo si su presencia disminuye el <span class="math inline">\(AIC\)</span>.</li>
<li>Un términa sale del modelo si su ausencia disminuye el <span class="math inline">\(AIC\)</span>.</li>
</ul>
</div>
<div id="función-stepaic" class="section level2 unnumbered hasAnchor">
<h2>Función <code>stepAIC</code><a href="selec.html#función-stepaic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>stepAIC</code> del paquete <strong>MASS</strong> <span class="citation">(<a href="#ref-R-MASS">Ripley 2024</a>)</span> es útil para hacer selección de variables en un modelo de regresión. La estructura de la función se muestra a continuación.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="selec.html#cb344-1" tabindex="-1"></a><span class="fu">stepAIC</span>(object, scope, <span class="at">scale =</span> <span class="dv">0</span>,</span>
<span id="cb344-2"><a href="selec.html#cb344-2" tabindex="-1"></a>        <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;backward&quot;</span>, <span class="st">&quot;forward&quot;</span>),</span>
<span id="cb344-3"><a href="selec.html#cb344-3" tabindex="-1"></a>        <span class="at">trace =</span> <span class="dv">1</span>, <span class="at">keep =</span> <span class="cn">NULL</span>, <span class="at">steps =</span> <span class="dv">1000</span>, <span class="at">use.start =</span> <span class="cn">FALSE</span>,</span>
<span id="cb344-4"><a href="selec.html#cb344-4" tabindex="-1"></a>        <span class="at">k =</span> <span class="dv">2</span>, ...)</span></code></pre></div>
<p>Algunos de los argumentos son:</p>
<ul>
<li><code>object</code>: un objeto con un modelo.</li>
<li><code>scope</code>: fórmula(s) con los límites de búsqueda.</li>
<li><code>direction</code>: los posibles valores son <code>both</code>, <code>backward</code>, <code>forward</code>.</li>
<li><code>trace</code>: valor lógico para indicar si se desea ver el paso a paso de la selección.</li>
<li><code>k</code>: valor de penalidad, por defecto es 2.</li>
</ul>
<div id="ejemplo-45" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="selec.html#ejemplo-45" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo se busca encontrar un modelo de regresion lineal que explique la variable respuesta <span class="math inline">\(y\)</span> en función de las covariables <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_{11}\)</span>, los datos provienen del ejercicio 9.5 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>.</p>
<p>A continuación se muestra el encabezado de la base de datos y la definición de las variables.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:selection02"></span>
<img src="images/tableb3.PNG" alt="Ilustración de la base de datos." width="786" />
<p class="caption">
Figure 16.2: Ilustración de la base de datos.
</p>
</div>
<p><strong>Nota</strong>: Type of transmission (1=automatic, 0=manual).</p>
<p><strong>Solución</strong></p>
<p>Antes de iniciar es necesario revisar si hay <code>NA's</code> y eliminarlos.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="selec.html#cb345-1" tabindex="-1"></a><span class="fu">library</span>(MPV)  <span class="co"># Aqui estan los datos</span></span>
<span id="cb345-2"><a href="selec.html#cb345-2" tabindex="-1"></a>table.b3[<span class="dv">22</span><span class="sc">:</span><span class="dv">26</span>, ] <span class="co"># Can you see the missing values?</span></span></code></pre></div>
<pre><code>##        y    x1  x2  x3  x4   x5 x6 x7    x8   x9  x10 x11
## 22 21.47 360.0 180 290 8.4 2.45  2  3 214.2 76.3 4250   1
## 23 16.59 400.0 185  NA 7.6 3.08  4  3 196.0 73.0 3850   1
## 24 31.90  96.9  75  83 9.0 4.30  2  5 165.2 61.8 2275   0
## 25 29.40 140.0  86  NA 8.0 2.92  2  4 176.4 65.4 2150   0
## 26 13.27 460.0 223 366 8.0 3.00  4  3 228.0 79.8 5430   1</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="selec.html#cb347-1" tabindex="-1"></a>datos <span class="ot">&lt;-</span> table.b3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">25</span>), ]</span></code></pre></div>
<p>El objeto <code>datos</code> tiene la base de datos sin las líneas con <code>NA</code>, lo mismo se hubiese podido realizar usando la función <code>na.omit</code>.</p>
<p>A continuación se muestran los diagramas de dispersión para las variables de la base de datos.</p>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:randomForest&#39;:
## 
##     outlier</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<p><img src="Regresion_con_R_files/figure-html/selection03-1.png" width="960" /></p>
</div>
<div id="aplicación-del-método-backward" class="section level3 unnumbered hasAnchor">
<h3>Aplicación del método <strong>backward</strong><a href="selec.html#aplicación-del-método-backward" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a crear un modelo <em>saturado</em>, es decir, el modelo mayor a considerar.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="selec.html#cb352-1" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data=</span>datos)</span>
<span id="cb352-2"><a href="selec.html#cb352-2" tabindex="-1"></a><span class="fu">summary</span>(full.model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ ., data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3441 -1.6711 -0.4486  1.4906  5.2508 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 17.339838  30.355375   0.571   0.5749  
## x1          -0.075588   0.056347  -1.341   0.1964  
## x2          -0.069163   0.087791  -0.788   0.4411  
## x3           0.115117   0.088113   1.306   0.2078  
## x4           1.494737   3.101464   0.482   0.6357  
## x5           5.843495   3.148438   1.856   0.0799 .
## x6           0.317583   1.288967   0.246   0.8082  
## x7          -3.205390   3.109185  -1.031   0.3162  
## x8           0.180811   0.130301   1.388   0.1822  
## x9          -0.397945   0.323456  -1.230   0.2344  
## x10         -0.005115   0.005896  -0.868   0.3971  
## x11          0.638483   3.021680   0.211   0.8350  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.227 on 18 degrees of freedom
## Multiple R-squared:  0.8355, Adjusted R-squared:  0.7349 
## F-statistic:  8.31 on 11 and 18 DF,  p-value: 5.231e-05</code></pre>
<p>De la tabla anterior se puede pensar en que hay un efecto de <span style="color:red">enmascaramiento</span> entre las variables ya que ninguna parece significativa marginalmente.</p>
<p>Se usa la función <code>stepAIC</code> y se elije <code>trace=TRUE</code> para obtener detalles del proceso de selección.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="selec.html#cb354-1" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># Para poder usar la funcion stepAIC</span></span>
<span id="cb354-2"><a href="selec.html#cb354-2" tabindex="-1"></a>modback <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full.model, <span class="at">trace=</span><span class="cn">TRUE</span>, <span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=78.96
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## 
##        Df Sum of Sq    RSS    AIC
## - x11   1     0.465 187.87 77.036
## - x6    1     0.632 188.03 77.063
## - x4    1     2.418 189.82 77.346
## - x2    1     6.462 193.86 77.979
## - x10   1     7.836 195.24 78.190
## - x7    1    11.065 198.47 78.683
## &lt;none&gt;              187.40 78.962
## - x9    1    15.758 203.16 79.384
## - x3    1    17.770 205.17 79.679
## - x1    1    18.736 206.14 79.820
## - x8    1    20.047 207.45 80.011
## - x5    1    35.864 223.26 82.215
## 
## Step:  AIC=77.04
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x6    1     0.536 188.40 75.121
## - x4    1     2.363 190.23 75.411
## - x2    1     6.642 194.51 76.078
## - x10   1     7.985 195.85 76.285
## &lt;none&gt;              187.87 77.036
## - x7    1    14.124 201.99 77.211
## - x9    1    16.914 204.78 77.622
## - x3    1    17.815 205.68 77.754
## - x1    1    18.280 206.15 77.822
## - x8    1    20.301 208.17 78.114
## - x5    1    36.370 224.24 80.345
## 
## Step:  AIC=75.12
## y ~ x1 + x2 + x3 + x4 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x4    1     3.451 191.85 73.666
## - x2    1     6.932 195.33 74.205
## - x10   1     9.351 197.75 74.574
## &lt;none&gt;              188.40 75.121
## - x7    1    14.473 202.87 75.342
## - x3    1    17.802 206.20 75.830
## - x9    1    18.146 206.55 75.880
## - x1    1    18.780 207.18 75.972
## - x8    1    21.244 209.65 76.326
## - x5    1    39.332 227.73 78.809
## 
## Step:  AIC=73.67
## y ~ x1 + x2 + x3 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x2    1    10.780 202.63 73.306
## - x7    1    11.113 202.97 73.355
## &lt;none&gt;              191.85 73.666
## - x10   1    14.988 206.84 73.923
## - x1    1    16.602 208.46 74.156
## - x9    1    18.072 209.92 74.366
## - x3    1    21.314 213.17 74.826
## - x8    1    28.835 220.69 75.867
## - x5    1    40.323 232.18 77.389
## 
## Step:  AIC=73.31
## y ~ x1 + x3 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x7    1    10.457 213.09 72.815
## - x3    1    10.595 213.23 72.835
## - x1    1    11.998 214.63 73.032
## - x9    1    12.643 215.28 73.122
## - x10   1    13.887 216.52 73.295
## &lt;none&gt;              202.63 73.306
## - x8    1    27.665 230.30 75.145
## - x5    1    30.191 232.82 75.472
## 
## Step:  AIC=72.82
## y ~ x1 + x3 + x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x3    1    4.8720 217.96 71.494
## - x9    1    5.2049 218.29 71.539
## - x1    1    5.3212 218.41 71.555
## &lt;none&gt;              213.09 72.815
## - x10   1   18.3677 231.46 73.296
## - x5    1   23.3458 236.44 73.934
## - x8    1   26.0316 239.12 74.273
## 
## Step:  AIC=71.49
## y ~ x1 + x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x1    1     0.765 218.73 69.599
## - x9    1     5.863 223.82 70.290
## &lt;none&gt;              217.96 71.494
## - x10   1    20.291 238.25 72.164
## - x5    1    23.020 240.98 72.506
## - x8    1    31.634 249.59 73.559
## 
## Step:  AIC=69.6
## y ~ x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x9    1     5.097 223.82 68.290
## &lt;none&gt;              218.73 69.599
## - x5    1    40.404 259.13 72.684
## - x8    1    57.407 276.13 74.591
## - x10   1   135.105 353.83 82.029
## 
## Step:  AIC=68.29
## y ~ x5 + x8 + x10
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              223.82 68.290
## - x5    1    36.314 260.14 70.800
## - x8    1    52.960 276.78 72.661
## - x10   1   194.838 418.66 85.076</code></pre>
<p>Para obtener un resumen del proceso se usa:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="selec.html#cb356-1" tabindex="-1"></a>modback<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## 
## Final Model:
## y ~ x5 + x8 + x10
## 
## 
##    Step Df   Deviance Resid. Df Resid. Dev      AIC
## 1                            18   187.4007 78.96155
## 2 - x11  1  0.4648362        19   187.8655 77.03587
## 3  - x6  1  0.5356445        20   188.4012 75.12128
## 4  - x4  1  3.4514854        21   191.8526 73.66591
## 5  - x2  1 10.7796848        22   202.6323 73.30587
## 6  - x7  1 10.4571693        23   213.0895 72.81545
## 7  - x3  1  4.8720101        24   217.9615 71.49363
## 8  - x1  1  0.7654631        25   218.7270 69.59881
## 9  - x9  1  5.0970905        26   223.8241 68.28989</code></pre>
<p>Para ver la tabla de resultados del modelo <code>modback</code>.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="selec.html#cb358-1" tabindex="-1"></a><span class="fu">summary</span>(modback)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x5 + x8 + x10, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6101 -1.9868 -0.6613  2.0369  5.8811 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.590404  11.771925   0.390   0.6998    
## x5           2.597240   1.264562   2.054   0.0502 .  
## x8           0.217814   0.087817   2.480   0.0199 *  
## x10         -0.009485   0.001994  -4.757 6.38e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.934 on 26 degrees of freedom
## Multiple R-squared:  0.8035, Adjusted R-squared:  0.7808 
## F-statistic: 35.44 on 3 and 26 DF,  p-value: 2.462e-09</code></pre>
</div>
<div id="aplicación-del-método-forward" class="section level3 unnumbered hasAnchor">
<h3>Aplicación del método <strong>forward</strong><a href="selec.html#aplicación-del-método-forward" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para aplicar este metodo se debe crear un modelo vacío (<code>empty.model</code>) del cual iniciará el proceso. Es necesario definir un punto final de búsqueda, ese punto es una fórmula que en este caso llamaremos <code>horizonte</code>. A continuación el codigo.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="selec.html#cb360-1" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>datos)</span>
<span id="cb360-2"><a href="selec.html#cb360-2" tabindex="-1"></a>horizonte <span class="ot">&lt;-</span> <span class="fu">formula</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6 <span class="sc">+</span> x7 <span class="sc">+</span> x8 <span class="sc">+</span> x9 <span class="sc">+</span> x10 <span class="sc">+</span> x11)</span></code></pre></div>
<p>Se usa la función <code>stepAIC</code> y se elije <code>trace=FALSE</code> para que NO se muestren los detalles del proceso de selección.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="selec.html#cb361-1" tabindex="-1"></a>modforw <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(empty.model, <span class="at">trace=</span><span class="cn">FALSE</span>, <span class="at">direction=</span><span class="st">&quot;forward&quot;</span>, <span class="at">scope=</span>horizonte)</span>
<span id="cb361-2"><a href="selec.html#cb361-2" tabindex="-1"></a>modforw<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ 1
## 
## Final Model:
## y ~ x1 + x4
## 
## 
##   Step Df  Deviance Resid. Df Resid. Dev       AIC
## 1                          29  1139.1050 111.10402
## 2 + x1  1 866.49528        28   272.6097  70.20532
## 3 + x4  1  18.57161        27   254.0381  70.08861</code></pre>
<p>Para ver la tabla de resultados del modelo <code>modforw</code>.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="selec.html#cb363-1" tabindex="-1"></a><span class="fu">summary</span>(modforw)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x4, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.5011 -2.1243 -0.3884  1.9964  6.9582 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.179421  18.787955   0.382    0.705    
## x1          -0.044479   0.005225  -8.513 3.98e-09 ***
## x4           3.077228   2.190294   1.405    0.171    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.067 on 27 degrees of freedom
## Multiple R-squared:  0.777,  Adjusted R-squared:  0.7605 
## F-statistic: 47.03 on 2 and 27 DF,  p-value: 1.594e-09</code></pre>
<p>Como la variable <span class="math inline">\(x_4\)</span> no es significativa, entonces se puede <span style="color:red">refinar</span> o actualizar el modelo <code>modforw</code> sacando <span class="math inline">\(x_4\)</span>, esto se puede realizar fácilmente por medio de la función <code>update</code> así:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="selec.html#cb365-1" tabindex="-1"></a>modforw <span class="ot">&lt;-</span> <span class="fu">update</span>(modforw, y <span class="sc">~</span> x1)</span>
<span id="cb365-2"><a href="selec.html#cb365-2" tabindex="-1"></a><span class="fu">summary</span>(modforw)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.6063 -2.0276 -0.0457  1.4531  7.0213 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 33.490010   1.535476  21.811  &lt; 2e-16 ***
## x1          -0.047026   0.004985  -9.434 3.43e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.12 on 28 degrees of freedom
## Multiple R-squared:  0.7607, Adjusted R-squared:  0.7521 
## F-statistic:    89 on 1 and 28 DF,  p-value: 3.429e-10</code></pre>
<p>En este <a href="https://www.researchgate.net/post/Why_stepAIC_gives_a_model_with_insignificant_variables_in_the_summarymodel2">enlace</a> usted podrá encontrar la respuesta que le dieron a Audrey al preguntar “Why stepAIC gives a model with insignificant variables?”.</p>
</div>
<div id="aplicación-del-método-both" class="section level3 unnumbered hasAnchor">
<h3>Aplicación del método <strong>both</strong><a href="selec.html#aplicación-del-método-both" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para aplicar este método se debe crear un modelo vacío del cual iniciará el proceso. Es necesario definir un punto final de búsqueda, ese punto es una <code>formula</code> que en este caso llamaremos <code>horizonte</code>. A continuación el código.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="selec.html#cb367-1" tabindex="-1"></a>modboth <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(empty.model, <span class="at">trace=</span><span class="cn">FALSE</span>, <span class="at">direction=</span><span class="st">&quot;both&quot;</span>, <span class="at">scope=</span>horizonte)</span>
<span id="cb367-2"><a href="selec.html#cb367-2" tabindex="-1"></a>modboth<span class="sc">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ 1
## 
## Final Model:
## y ~ x1 + x4
## 
## 
##   Step Df  Deviance Resid. Df Resid. Dev       AIC
## 1                          29  1139.1050 111.10402
## 2 + x1  1 866.49528        28   272.6097  70.20532
## 3 + x4  1  18.57161        27   254.0381  70.08861</code></pre>
<p>El modelo <code>modboth</code> y <code>modforw</code> son el mismo.</p>
<p>A continuación vamos a realizar una comparación de los modelos obtenidos.</p>
<div id="comparando-r2_adj" class="section level4 unnumbered hasAnchor">
<h4>Comparando <span class="math inline">\(R^2_{Adj}\)</span><a href="selec.html#comparando-r2_adj" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para extraer el <span class="math inline">\(R^2_{Adj}\)</span> de la tabla de resultados se usa:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="selec.html#cb369-1" tabindex="-1"></a><span class="fu">summary</span>(modback)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.7808368</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="selec.html#cb371-1" tabindex="-1"></a><span class="fu">summary</span>(modforw)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.7521337</code></pre>
</div>
<div id="comparando-hatsigma" class="section level4 unnumbered hasAnchor">
<h4>Comparando <span class="math inline">\(\hat{\sigma}\)</span><a href="selec.html#comparando-hatsigma" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para extraer el <span class="math inline">\(\hat{\sigma}\)</span> de la tabla de resultados se usa:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="selec.html#cb373-1" tabindex="-1"></a><span class="fu">summary</span>(modback)<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 2.934045</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="selec.html#cb375-1" tabindex="-1"></a><span class="fu">summary</span>(modforw)<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 3.120266</code></pre>
</div>
<div id="comparando-los-residuales" class="section level4 unnumbered hasAnchor">
<h4>Comparando los residuales<a href="selec.html#comparando-los-residuales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="selec.html#cb377-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb377-2"><a href="selec.html#cb377-2" tabindex="-1"></a><span class="fu">plot</span>(modback, <span class="at">main=</span><span class="st">&quot;Backward&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">which=</span><span class="dv">1</span>)</span>
<span id="cb377-3"><a href="selec.html#cb377-3" tabindex="-1"></a><span class="fu">plot</span>(modforw, <span class="at">main=</span><span class="st">&quot;Forward&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/selection04-1.png" width="768" /></p>
</div>
</div>
<div id="ejercicios" class="section level3 unnumbered hasAnchor">
<h3>Ejercicios<a href="selec.html#ejercicios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>¿Qué patrón observa en los gráficos?</li>
<li>Para cada uno de los dos modelos incluya términos cuadráticos con el objetivo de explicar ese patrón cuadrático no explicado y mostrado en los gráficos de residuales anteriores.</li>
</ol>
</div>
</div>
<div id="funciones-addterm-y-dropterm" class="section level2 unnumbered hasAnchor">
<h2>Funciones <code>addterm</code> y <code>dropterm</code><a href="selec.html#funciones-addterm-y-dropterm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Estas dos funciones pertenecen al paquete <strong>MASS</strong> <span class="citation">(<a href="#ref-R-MASS">Ripley 2024</a>)</span> y son útiles para agregar/quitar 1 variable con respecto al modelo ingresado. A continuación la estructura de las funciones.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="selec.html#cb378-1" tabindex="-1"></a><span class="fu">addterm</span>(object, ...)</span>
<span id="cb378-2"><a href="selec.html#cb378-2" tabindex="-1"></a><span class="fu">dropterm</span> (object, ...)</span></code></pre></div>
<div id="ejemplo-46" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="selec.html#ejemplo-46" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando datos anteriores ajuste un modelo para explicar <code>y</code> en función de <code>x2</code> y <code>x5</code>, luego use <code>addterm</code> para determinar cual de las variables <code>x1</code>, <code>x4</code> y <code>x6</code> se debería ingresar.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="selec.html#cb379-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x5, <span class="at">data=</span>datos)</span>
<span id="cb379-2"><a href="selec.html#cb379-2" tabindex="-1"></a>maximo <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span>
<span id="cb379-3"><a href="selec.html#cb379-3" tabindex="-1"></a><span class="fu">addterm</span>(mod1, <span class="at">scope=</span>maximo)</span></code></pre></div>
<pre><code>## Single term additions
## 
## Model:
## y ~ x2 + x5
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              353.19 79.974
## x1      1    88.511 264.67 73.319
## x3      1    47.296 305.89 77.661
## x4      1    19.915 333.27 80.233
## x6      1    19.452 333.73 80.274</code></pre>
<p>De la salida anterior se ve que ingresar <code>x1</code> mejoraría el modelo porque lo llevaría de un <span class="math inline">\(AIC=79.974\)</span> a uno con <span class="math inline">\(AIC=73.319\)</span>.</p>
</div>
</div>
<div id="paquete-mixlm" class="section level2 unnumbered hasAnchor">
<h2>Paquete <strong>mixlm</strong><a href="selec.html#paquete-mixlm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El paquete <strong>mixlm</strong> creado por <span class="citation">Liland (<a href="#ref-R-mixlm">2023</a>)</span> contiene un buen número de funciones para modelación. Algunas de las funciones a destacar son <code>forward</code>, <code>backward</code>, <code>stepWise</code>.</p>

<div class="rmdwarning">
Este paquete contiene otras funciones <code>lm</code> y <code>glm</code> que se pueden confundir con las funciones <code>lm</code> y <code>glm</code> del paquete <strong>stats</strong>. Por esta razón el usuario debe tener cuidado de usar la apropiada, en estos casos se recomienda usar <code>stats::lm(y ~ x)</code> o <code>mixlm::lm(y ~ x)</code> para obligar a R a que use la que el usuario desea.
</div>
<div id="ejemplo-47" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="selec.html#ejemplo-47" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo se retoman los datos del ejercicio 9.5 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>. En este ejemplo se busca encontrar un modelo de regresion lineal que explique la variable respuesta <span class="math inline">\(y\)</span> en función de las covariables <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_{11}\)</span>, usando el modelo backward y que todas las variables sean significativas a un nivel del 4%.</p>
<p>Para realizar lo solicitado se usa el siguiente código:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="selec.html#cb381-1" tabindex="-1"></a><span class="fu">library</span>(MPV) <span class="co"># Aqui estan los datos</span></span>
<span id="cb381-2"><a href="selec.html#cb381-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> table.b3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">25</span>), ] <span class="co"># Eliminando 2 observaciones con NA</span></span>
<span id="cb381-3"><a href="selec.html#cb381-3" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6 <span class="sc">+</span> x7 <span class="sc">+</span> x8 <span class="sc">+</span> x9 <span class="sc">+</span> x10 <span class="sc">+</span> x11,</span>
<span id="cb381-4"><a href="selec.html#cb381-4" tabindex="-1"></a>             <span class="at">data=</span>datos)</span>
<span id="cb381-5"><a href="selec.html#cb381-5" tabindex="-1"></a></span>
<span id="cb381-6"><a href="selec.html#cb381-6" tabindex="-1"></a><span class="fu">library</span>(mixlm)</span>
<span id="cb381-7"><a href="selec.html#cb381-7" tabindex="-1"></a><span class="fu">backward</span>(modelo, <span class="at">alpha=</span><span class="fl">0.04</span>)</span></code></pre></div>
<pre><code>## Backward elimination, alpha-to-remove: 0.04
## 
## Full model: y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## 
##     Step    RSS    AIC  R2pred       Cp F value  Pr(&gt;F)  
## x11    1 187.87 77.036 0.41925 10.04465  0.0446 0.83503  
## x6     2 188.40 75.121 0.51334  8.09610  0.0542 0.81844  
## x4     3 191.85 73.666 0.53495  6.42762  0.3664 0.55178  
## x2     4 202.63 73.306 0.54991  5.46301  1.1799 0.28968  
## x7     5 213.09 72.815 0.61766  4.46743  1.1353 0.29819  
## x3     6 217.96 71.494 0.63898  2.93539  0.5259 0.47566  
## x1     7 218.73 69.599 0.66089  1.00892  0.0843 0.77406  
## x9     8 223.82 68.290 0.73638 -0.50150  0.5826 0.45244  
## x5     9 260.14 70.800 0.70705  0.98652  4.2184 0.05017 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ x8 + x10, data = datos)
## 
## Coefficients:
## (Intercept)           x8          x10  
##    16.23496      0.21234     -0.01022</code></pre>
<p>De la salida anterior vemos que el modelo final es <code>y ~ x8 + x10</code>. Si comparamos este modelo con el obtenido al usar la función <code>stepAIC</code>, vemos que se eliminó la variable <code>x5</code> ya que su valor-P era 5.02%, superior al límite definido aquí del 4%.</p>
</div>
</div>
<div id="paquete-leaps" class="section level2 unnumbered hasAnchor">
<h2>Paquete <strong>leaps</strong><a href="selec.html#paquete-leaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El paquete <strong>leaps</strong> creado por <span class="citation">Lumley (<a href="#ref-R-leaps">2020</a>)</span> está basado en <a href="https://es.wikipedia.org/wiki/Fortran">Fortran</a> y es útil cuando nos interese encontrar subconjuntos de covariables para optimizar las características de un modelo.</p>
<p>La función <code>regsubsets</code> realiza una búsqueda exhaustiva de los mejores subconjuntos de variables <span class="math inline">\(x\)</span> para explicar <span class="math inline">\(y\)</span>. La búsqueda utiliza un algoritmo eficiente de ramificación y unión.</p>
<p>La estructura de la función es la siguiente:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="selec.html#cb384-1" tabindex="-1"></a><span class="fu">regsubsets</span>(x, data, nbest, nvmax, ...)</span></code></pre></div>
<p>Algunos de los parámetros más usuados en la función son:</p>
<ul>
<li><code>x</code>: fórmula usual.</li>
<li><code>data</code>: marco de datos.</li>
<li><code>nbest</code>: número de subconjuntos de cada tamaño a guardar.</li>
<li><code>nvmax</code>: máximo número de subconjuntos a evaluar.</li>
</ul>
<div id="ejemplo-48" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="selec.html#ejemplo-48" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo vamos a usar la base de datos <code>mtcars</code> para encontrar los <strong>dos</strong> mejores modelos con 1, 2, 3 y 4 covariables para explicar <code>mpg</code> en función de las variables <code>disp</code>, <code>hp</code>, <code>wt</code>, <code>qsec</code>.</p>
<p>Para hacer la búsqueda usamos el siguiente código. <code>nbest=2</code> porque queremos los mejores <strong>dos</strong> modelos con cada número de covariables posible.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="selec.html#cb385-1" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb385-2"><a href="selec.html#cb385-2" tabindex="-1"></a>model_subset <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, </span>
<span id="cb385-3"><a href="selec.html#cb385-3" tabindex="-1"></a>                           <span class="at">data=</span>mtcars, <span class="at">nbest=</span><span class="dv">2</span>, <span class="at">nvmax=</span><span class="dv">13</span>)</span></code></pre></div>
<p>El <code>model_subset</code> es un objeto de la clase <code>regsubsets</code> y es posible usar la función S3 <code>summary</code> para objetos de esa clase. A continuación los elementos que componen <code>summary</code>.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="selec.html#cb386-1" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">summary</span>(model_subset))</span></code></pre></div>
<pre><code>## [1] &quot;which&quot;  &quot;rsq&quot;    &quot;rss&quot;    &quot;adjr2&quot;  &quot;cp&quot;     &quot;bic&quot;    &quot;outmat&quot; &quot;obj&quot;</code></pre>
<p>El primer elemento del <code>summary</code> se obtiene así:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="selec.html#cb388-1" tabindex="-1"></a><span class="fu">summary</span>(model_subset)<span class="sc">$</span>which</span></code></pre></div>
<pre><code>##   (Intercept)  disp    hp    wt  qsec
## 1        TRUE FALSE FALSE  TRUE FALSE
## 1        TRUE  TRUE FALSE FALSE FALSE
## 2        TRUE FALSE  TRUE  TRUE FALSE
## 2        TRUE FALSE FALSE  TRUE  TRUE
## 3        TRUE FALSE  TRUE  TRUE  TRUE
## 3        TRUE  TRUE  TRUE  TRUE FALSE
## 4        TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>De las dos primeras líneas de la salida anterior se observa que los dos mejores modelos con <strong>una</strong> sola covariable son <code>mpg ~ wt</code> y <code>mpg ~ disp</code>. De forma similar, los dos mejores modelos con <strong>dos</strong> covariables son <code>mpg ~ hp + wt</code> y <code>mpg ~ wt + qsec</code>. De forma análoga se interpretan las líneas de la salida anterior.</p>
<p>Es posible mostrar gráficamente los resultados anteriores usando el método S3 <code>plot</code> para objetos de la clase <code>regsubsets</code>. A continuación la estructura de la función <code>plot</code>. El parámetro <code>scale</code> nos permite explorar los mejores modelos para cada uno de los cuatro criterios <span class="math inline">\(BIC\)</span>, <span class="math inline">\(C_p\)</span>, <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="selec.html#cb390-1" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">labels=</span>obj<span class="sc">$</span>xnames, <span class="at">main=</span><span class="cn">NULL</span>, </span>
<span id="cb390-2"><a href="selec.html#cb390-2" tabindex="-1"></a>     <span class="at">scale=</span><span class="fu">c</span>(<span class="st">&quot;bic&quot;</span>, <span class="st">&quot;Cp&quot;</span>, <span class="st">&quot;adjr2&quot;</span>, <span class="st">&quot;r2&quot;</span>),</span>
<span id="cb390-3"><a href="selec.html#cb390-3" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">gray</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="at">length =</span> <span class="dv">10</span>)),...)</span></code></pre></div>
<p>A continuación el código para mostrar gráficamente los mejores modelos usando el criterio <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(BIC\)</span>.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="selec.html#cb391-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb391-2"><a href="selec.html#cb391-2" tabindex="-1"></a><span class="fu">plot</span>(model_subset, <span class="at">scale=</span><span class="st">&quot;adjr2&quot;</span>, <span class="at">main=</span><span class="fu">expression</span>(R[Adj]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb391-3"><a href="selec.html#cb391-3" tabindex="-1"></a><span class="fu">plot</span>(model_subset, <span class="at">scale=</span><span class="st">&quot;bic&quot;</span>, <span class="at">main=</span><span class="st">&quot;BIC&quot;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/selection06-1.png" width="960" /></p>
<p>De la figura de la izquierda vemos que:</p>
<ul>
<li>El modelo con mayor <span class="math inline">\(R^2_{adj}\)</span> es <code>mpg ~ hp + wt + qsec</code>.</li>
<li>El modelo <code>mpg ~ hp + wt</code> tiene igual <span class="math inline">\(R^2_{adj}\)</span> que <code>mpg ~ wt + qsec</code>.</li>
<li>El mejor modelo con una sola covariable es <code>mpg ~ wt</code>.</li>
</ul>
<p>La figura de la derecha se puede analizar de forma análoga.</p>
<p>Para obtener los valores exacto de <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(BIC\)</span> mostrados en la figura anterior se usa el siguiente código.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="selec.html#cb392-1" tabindex="-1"></a><span class="fu">summary</span>(model_subset)<span class="sc">$</span>adjr2</span></code></pre></div>
<pre><code>## [1] 0.7445939 0.7089548 0.8148396 0.8144448 0.8170643 0.8082829 0.8107212</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="selec.html#cb394-1" tabindex="-1"></a><span class="fu">summary</span>(model_subset)<span class="sc">$</span>bic</span></code></pre></div>
<pre><code>## [1] -37.79462 -33.61466 -45.70597 -45.63781 -43.74996 -42.24960 -40.35723</code></pre>
<p>Para encontrar el modelo con el mejor <span class="math inline">\(BIC\)</span> se puede usar lo siguiente:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="selec.html#cb396-1" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">summary</span>(model_subset)<span class="sc">$</span>bic <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">summary</span>(model_subset)<span class="sc">$</span>bic))</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Para determinar la estructura del <span style="color:orange">modelo 3</span> identificado en la salida anterior usamos:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="selec.html#cb398-1" tabindex="-1"></a><span class="fu">summary</span>(model_subset)<span class="sc">$</span>which[<span class="dv">3</span>, ]</span></code></pre></div>
<pre><code>## (Intercept)        disp          hp          wt        qsec 
##        TRUE       FALSE        TRUE        TRUE       FALSE</code></pre>
</div>
</div>
<div id="funciones-para-el-curso-estadística-ii" class="section level2 unnumbered hasAnchor">
<h2>Funciones para el curso Estadística II<a href="selec.html#funciones-para-el-curso-estadística-ii" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El curso de Estadística II tiene unas funciones especiales (<code>myStepwise</code> y <code>myBackward</code>) para realizar la selección de variables según se ha explicado en clase.</p>
<p>Para accerder a estas funciones se corre el siguiente código:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="selec.html#cb400-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/fhernanb/Trabajos_Est_2/main/Trabajo%201/funciones.R&quot;</span>)</span></code></pre></div>
<div id="ejemplo-49" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="selec.html#ejemplo-49" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo se busca encontrar un modelo de regresion lineal que explique la variable respuesta <span class="math inline">\(y\)</span> en función de las covariables <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_{11}\)</span>, los datos provienen del ejercicio 9.5 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>.</p>
<p>A continuación se muestra el encabezado de la base de datos y la definición de las variables.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:selectionEstII01"></span>
<img src="images/tableb3.PNG" alt="Ilustración de la base de datos." width="786" />
<p class="caption">
Figure 16.3: Ilustración de la base de datos.
</p>
</div>
<p><strong>Nota</strong>: Type of transmission (1=automatic, 0=manual).</p>
<p><strong>Solución</strong></p>
<p>Antes de iniciar es necesario revisar si hay <code>NA's</code> y eliminarlos.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="selec.html#cb401-1" tabindex="-1"></a><span class="fu">library</span>(MPV)  <span class="co"># Aqui estan los datos</span></span>
<span id="cb401-2"><a href="selec.html#cb401-2" tabindex="-1"></a>table.b3[<span class="dv">22</span><span class="sc">:</span><span class="dv">26</span>, ] <span class="co"># Can you see the missing values?</span></span></code></pre></div>
<pre><code>##        y    x1  x2  x3  x4   x5 x6 x7    x8   x9  x10 x11
## 22 21.47 360.0 180 290 8.4 2.45  2  3 214.2 76.3 4250   1
## 23 16.59 400.0 185  NA 7.6 3.08  4  3 196.0 73.0 3850   1
## 24 31.90  96.9  75  83 9.0 4.30  2  5 165.2 61.8 2275   0
## 25 29.40 140.0  86  NA 8.0 2.92  2  4 176.4 65.4 2150   0
## 26 13.27 460.0 223 366 8.0 3.00  4  3 228.0 79.8 5430   1</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="selec.html#cb403-1" tabindex="-1"></a>datos <span class="ot">&lt;-</span> table.b3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">25</span>), ]</span></code></pre></div>
<p>El objeto <code>datos</code> tiene la base de datos sin las líneas con <code>NA</code>, lo mismo se hubiese podido realizar usando la función <code>na.omit</code>.</p>
<p>A continuación se muestran los diagramas de dispersión para las variables de la base de datos.
<img src="Regresion_con_R_files/figure-html/selectionEstII02-1.png" width="960" /></p>
<p>Ahora vamos a ajustar el modelo saturado, es decir, el modelo con todas las covariables.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="selec.html#cb404-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data=</span>table.b3)</span></code></pre></div>
<p>Para aplicar el modelo Forward visto en clase usamos la siguiente instrucción.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="selec.html#cb405-1" tabindex="-1"></a><span class="fu">attach</span>(table.b3)</span></code></pre></div>
<pre><code>## The following objects are masked _by_ .GlobalEnv:
## 
##     x1, x2, y</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="selec.html#cb407-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">myStepwise</span>(<span class="at">full.model=</span>mod, <span class="at">alpha.to.enter=</span><span class="fl">0.05</span>, <span class="at">alpha.to.leave=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 20.03833   1.144254 17.51214 5.810909e-17
## 
## S = 6.267335, R-sq = 0.000000, R-sq(adj) = 0.000000, C-p = 81.412038
## =====</code></pre>
<p>Para ver un resumen del modelo resultante de Forward hacemos lo siguiente:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="selec.html#cb409-1" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = initial.model)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.8383 -3.6058 -0.7383  1.4542 16.4617 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.038      1.144   17.51   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## s: 6.267 on 29 degrees of freedom</code></pre>
<p>Para aplicar el modelo Backward visto en clase usamos la siguiente instrucción.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="selec.html#cb411-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">myBackward</span>(<span class="at">base.full=</span>mod, <span class="at">alpha.to.leave=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## -------------STEP  1 -------------
##  The drop statistics : 
## Single term deletions
## 
## Model:
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
##        Df Sum of Sq    RSS    AIC F value Pr(&gt;F)  
## &lt;none&gt;              187.40 78.962                 
## x1      1    18.736 206.14 79.820  1.7996 0.1964  
## x2      1     6.462 193.86 77.979  0.6207 0.4411  
## x3      1    17.770 205.17 79.679  1.7069 0.2078  
## x4      1     2.418 189.82 77.346  0.2323 0.6357  
## x5      1    35.864 223.26 82.215  3.4447 0.0799 .
## x6      1     0.632 188.03 77.063  0.0607 0.8082  
## x7      1    11.065 198.47 78.683  1.0628 0.3162  
## x8      1    20.047 207.45 80.011  1.9256 0.1822  
## x9      1    15.758 203.16 79.384  1.5136 0.2344  
## x10     1     7.836 195.24 78.190  0.7526 0.3971  
## x11     1     0.465 187.87 77.036  0.0446 0.8350  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## --------
## Term dropped in step 1 : x11 
## --------

.
.
.

## -------------STEP  9 -------------
##  The drop statistics : 
## Single term deletions
## 
## Model:
## y ~ x5 + x8 + x10
##        Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
## &lt;none&gt;              228.85 70.955                      
## x5      1    38.934 267.78 73.982  4.7636   0.03761 *  
## x8      1    59.013 287.86 76.296  7.2203   0.01199 *  
## x10     1   245.912 474.76 92.306 30.0876 7.375e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Para ver un resumen del modelo resultante de Backward hacemos lo siguiente:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="selec.html#cb413-1" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x5 + x8 + x10)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.512 -1.945 -0.631  1.931  6.003 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.010946  11.275042   0.444   0.6601    
## x5           2.625031   1.202720   2.183   0.0376 *  
## x8           0.211874   0.078850   2.687   0.0120 *  
## x10         -0.009334   0.001702  -5.485 7.37e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## s: 2.859 on 28 degrees of freedom
## Multiple R-squared: 0.8151,
## Adjusted R-squared: 0.7953 
## F-statistic: 41.14 on 3 and 28 DF,  p-value: 2.156e-10</code></pre>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-mixlm" class="csl-entry">
Liland, Kristian Hovde. 2023. <em>Mixlm: Mixed Model ANOVA and Statistics for Education</em>. <a href="https://github.com/khliland/mixlm/">https://github.com/khliland/mixlm/</a>.
</div>
<div id="ref-R-leaps" class="csl-entry">
Lumley, Thomas. 2020. <em>Leaps: Regression Subset Selection</em>. <a href="https://CRAN.R-project.org/package=leaps">https://CRAN.R-project.org/package=leaps</a>.
</div>
<div id="ref-R-MASS" class="csl-entry">
Ripley, Brian. 2024. <em>MASS: Support Functions and Datasets for Venables and Ripley’s MASS</em>. <a href="http://www.stats.ox.ac.uk/pub/MASS4/">http://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="allpossibleregre.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="feature_selec.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_regresion/edit/master/16-selecvar.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
