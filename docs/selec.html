<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Selección de variables | Modelos de Regresión con R</title>
  <meta name="description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Selección de variables | Modelos de Regresión con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="github-repo" content="fhernanb/libro_regresion" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Selección de variables | Modelos de Regresión con R" />
  
  <meta name="twitter:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Freddy Hernández" />
<meta name="author" content="Mauricio Mazo" />


<meta name="date" content="2020-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mod-poli.html"/>
<link rel="next" href="feature-selec.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos de Regresión con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>1</b> Regresión lineal simple</a><ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#modelo-estadístico"><i class="fa fa-check"></i>Modelo estadístico</a></li>
<li><a href="rls.html#función-lm">Función <code>lm</code></a><ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="rls.html#clase-lm">Clase <code>lm</code></a><ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#mínimos-cuadrados-ponderados"><i class="fa fa-check"></i>Mínimos cuadrados ponderados</a><ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#apéndice"><i class="fa fa-check"></i>Apéndice</a><ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-mínimos-cuadrados"><i class="fa fa-check"></i>Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Estimación por máxima verosimilitud</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>2</b> Regresión lineal múltiple</a><ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#modelo-estadístico-1"><i class="fa fa-check"></i>Modelo estadístico</a><ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predict.html"><a href="predict.html"><i class="fa fa-check"></i><b>3</b> Predicción</a><ul>
<li><a href="predict.html#función-predict">Función <code>predict</code></a><ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="predict.html#intervalo-de-confianza-para-la-respuesta-media-eyx_0">Intervalo de confianza para la respuesta media <span class="math inline">\(E(y|x_0)\)</span></a></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-predicción-de-nuevas-observaciones"><i class="fa fa-check"></i>Intervalo de confianza para la predicción de nuevas observaciones</a><ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simul.html"><a href="simul.html"><i class="fa fa-check"></i><b>4</b> Simulación</a><ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#preguntas-sobre-simulación-en-stackoverflow"><i class="fa fa-check"></i>Preguntas sobre simulación en StackOverFlow</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#simulando-datos-de-un-modelo-lineal"><i class="fa fa-check"></i>Simulando datos de un modelo lineal</a><ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="simul.html#función-simulate">Función <code>simulate</code></a><ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#otras-herramientas-para-simular"><i class="fa fa-check"></i>Otras herramientas para simular</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#videos-sugeridos"><i class="fa fa-check"></i>Videos sugeridos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ic.html"><a href="ic.html"><i class="fa fa-check"></i><b>5</b> Intervalos de confianza</a><ul>
<li><a href="ic.html#función-confint">Función <code>confint</code></a><ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="ic.html#función-confint_sigma2">Función <code>confint_sigma2</code></a><ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="varcuali.html"><a href="varcuali.html"><i class="fa fa-check"></i><b>6</b> Modelos con variables cualitativas</a><ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#es-posible-incluir-variables-cualitativas"><i class="fa fa-check"></i>¿Es posible incluir variables cualitativas?</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#variable-indicadora-dummy-ficticia-o-binaria"><i class="fa fa-check"></i>Variable indicadora, dummy, ficticia o binaria</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#creando-variables-indicadoras"><i class="fa fa-check"></i>Creando variables indicadoras</a><ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-10"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#modelos-con-variables-cualitativas"><i class="fa fa-check"></i>Modelos con variables cualitativas</a><ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-11"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#significancia-de-variables-cualitativas"><i class="fa fa-check"></i>Significancia de variables cualitativas</a><ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-13"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ph1.html"><a href="ph1.html"><i class="fa fa-check"></i><b>7</b> Pruebas de hipótesis parte I</a><ul>
<li><a href="ph1.html#pruebas-sobre-los-coeficientes-beta">Pruebas sobre los coeficientes <span class="math inline">\(\beta\)</span></a></li>
<li><a href="ph1.html#función-summary-cuando-beta_j0-0">Función <code>summary</code> cuando <span class="math inline">\(\beta_{j0} = 0\)</span></a><ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="ph1.html#función-beta_test-cuando-beta_k0-neq-0">Función <code>beta_test</code> cuando <span class="math inline">\(\beta_{k0} \neq 0\)</span></a><ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ph2.html"><a href="ph2.html"><i class="fa fa-check"></i><b>8</b> Pruebas de hipótesis parte II</a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-sobre-todos-los-coeficientes"><i class="fa fa-check"></i>Prueba sobre todos los coeficientes</a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-para-comparar-modelos-anidados"><i class="fa fa-check"></i>Prueba para comparar modelos anidados</a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-17"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="ph2.html#función-anova">Función <code>anova</code></a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="ph2.html#summary-versus-anova"><code>summary</code> versus <code>anova</code></a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-20"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i>Prueba razón de verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-21"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#comparaciones-múltiples"><i class="fa fa-check"></i>Comparaciones múltiples</a><ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-22"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diag1.html"><a href="diag1.html"><i class="fa fa-check"></i><b>9</b> Diagnósticos parte I</a><ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#residuales"><i class="fa fa-check"></i>Residuales</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-23"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#supuestos"><i class="fa fa-check"></i>Supuestos</a></li>
<li><a href="diag1.html#chequeando-normalidad-de-los-errores-e_i">Chequeando normalidad de los errores <span class="math inline">\(e_i\)</span></a></li>
<li><a href="diag1.html#chequeando-si-errores-e_i-con-media-cero">Chequeando si errores <span class="math inline">\(e_i\)</span> con media cero</a></li>
<li><a href="diag1.html#chequeando-si-los-errores-e_i-tiene-varianza-constante">Chequeando si los errores <span class="math inline">\(e_i\)</span> tiene varianza constante</a></li>
<li><a href="diag1.html#chequeando-si-errores-e_i-no-están-correlacionados">Chequeando si errores <span class="math inline">\(e_i\)</span> no están correlacionados</a><ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#reto-para-el-lector"><i class="fa fa-check"></i>Reto para el lector</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#gráficos-de-residuales-usando-car"><i class="fa fa-check"></i>Gráficos de residuales usando car</a><ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-25"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diag2.html"><a href="diag2.html"><i class="fa fa-check"></i><b>10</b> Diagnósticos parte II</a><ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#matriz-sombrero-o-hat"><i class="fa fa-check"></i>Matriz sombrero o hat</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#qué-es-extrapolación-oculta"><i class="fa fa-check"></i>¿Qué es extrapolación oculta?</a><ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-26"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#reto-para-el-lector-1"><i class="fa fa-check"></i>Reto para el lector</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#punto-atípico-outlier-y-punto-influyente"><i class="fa fa-check"></i>Punto atípico (outlier) y punto influyente</a></li>
<li class="chapter" data-level="10.1" data-path="diag2.html"><a href="diag2.html#prueba-de-bonferroni-para-detectar-outliers"><i class="fa fa-check"></i><b>10.1</b> Prueba de Bonferroni para detectar outliers</a><ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-27"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#distancia-de-cook"><i class="fa fa-check"></i>Distancia de Cook</a><ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-cómo-se-relaciona-el-peso-corporal-con-la-circunferencia-de-la-muñeca-cuello-y-estatura"><i class="fa fa-check"></i>Ejemplo: ¿cómo se relaciona el peso corporal con la circunferencia de la muñeca, cuello y estatura?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dffits"><i class="fa fa-check"></i>DFFITS</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dfbetas"><i class="fa fa-check"></i>DFBETAS</a><ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-28"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-poli.html"><a href="mod-poli.html"><i class="fa fa-check"></i><b>11</b> Modelos polinomiales</a><ul>
<li><a href="mod-poli.html#funciones-i-y-poly">Funciones <code>I()</code> y <code>poly()</code></a><ul>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-29"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-30"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="mod-poli.html#función-bs">Función <code>bs</code></a><ul>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-31"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="mod-poli.html#función-lowess">Función <code>lowess</code></a><ul>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="mod-poli.html#función-loess">Función <code>loess</code></a><ul>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#optimización-con-superficies-de-respuesta"><i class="fa fa-check"></i>Optimización con superficies de respuesta</a><ul>
<li><a href="mod-poli.html#función-nlminb">Función <code>nlminb</code></a></li>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod-poli.html"><a href="mod-poli.html#polinomios-ortogonales"><i class="fa fa-check"></i>Polinomios ortogonales</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="selec.html"><a href="selec.html"><i class="fa fa-check"></i><b>12</b> Selección de variables</a><ul>
<li><a href="selec.html#akaike-information-criterion-aic">Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)</a></li>
<li><a href="selec.html#funciones-loglik-y-aic">Funciones <code>logLik</code> y <code>AIC</code></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#métodos"><i class="fa fa-check"></i>Métodos</a></li>
<li><a href="selec.html#función-stepaic">Función <code>stepAIC</code></a><ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-35"><i class="fa fa-check"></i>Ejemplo</a></li>
<li><a href="selec.html#aplicación-del-método-backward">Aplicación del método <strong>backward</strong></a></li>
<li><a href="selec.html#aplicación-del-método-forward">Aplicación del método <strong>forward</strong></a></li>
<li><a href="selec.html#aplicación-del-método-both">Aplicación del método <strong>both</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li><a href="selec.html#funciones-addterm-y-dropterm">Funciones <code>addterm</code> y <code>dropterm</code></a><ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-36"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="selec.html#paquete-olsrr">Paquete <strong>olsrr</strong></a><ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-37"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="selec.html#paquete-mixlm">Paquete <strong>mixlm</strong></a><ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-38"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li><a href="selec.html#paquete-leaps">Paquete <strong>leaps</strong></a><ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-39"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="feature-selec.html"><a href="feature-selec.html"><i class="fa fa-check"></i><b>13</b> Feature selection</a><ul>
<li class="chapter" data-level="" data-path="feature-selec.html"><a href="feature-selec.html#feature-selection-with-the-caret-r-package"><i class="fa fa-check"></i>Feature Selection with the Caret R Package</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="algmat.html"><a href="algmat.html"><i class="fa fa-check"></i><b>14</b> Algebra matricial con R</a><ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#matrices"><i class="fa fa-check"></i>Matrices</a><ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-40"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#operaciones-básicas-sobre-una-matriz"><i class="fa fa-check"></i>Operaciones básicas sobre una matriz</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#rango-de-una-matriz"><i class="fa fa-check"></i>Rango de una matriz</a><ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-41"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-42"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="WilRog.html"><a href="WilRog.html"><i class="fa fa-check"></i><b>15</b> Notación de Wilkinson y Rogers</a><ul>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#qué-es-una-fórmula-en-r"><i class="fa fa-check"></i>¿Qué es una fórmula en R?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#para-qué-sirve-la-notación-de-wilkinson-y-rogers"><i class="fa fa-check"></i>¿Para qué sirve la notación de Wilkinson y Rogers?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#paquete-formula-de-r"><i class="fa fa-check"></i>Paquete Formula de R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="xy.html"><a href="xy.html"><i class="fa fa-check"></i><b>16</b> ¿Cómo obtener la matriz <span class="math inline">\(\boldsymbol{X}\)</span> y el vector <span class="math inline">\(\boldsymbol{y}\)</span>?</a><ul>
<li class="chapter" data-level="" data-path="xy.html"><a href="xy.html#ejemplo-43"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="important.html"><a href="important.html"><i class="fa fa-check"></i><b>17</b> Otros aspectos importantes</a><ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#qué-otras-funciones-hay-en-r-para-ajustar-un-modelo"><i class="fa fa-check"></i>¿Qué otras funciones hay en R para ajustar un modelo?</a></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#modelos-de-regresión-con-grandes-conjuntos-de-datos"><i class="fa fa-check"></i>Modelos de regresión con grandes conjuntos de datos</a></li>
<li><a href="important.html#fast-lm-in-r">Fast <code>lm</code> in R</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="pasos.html"><a href="pasos.html"><i class="fa fa-check"></i><b>18</b> Pasos para construir modelos</a><ul>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-construir-un-modelo"><i class="fa fa-check"></i>Pasos para construir UN modelo</a></li>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-comparar-varios-modelos"><i class="fa fa-check"></i>Pasos para comparar varios modelos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="selec" class="section level1">
<h1><span class="header-section-number">12</span> Selección de variables</h1>
<p>En este capítulo se muestra como realizar selección de variables en un modelo de regresión lineal.</p>
<div id="akaike-information-criterion-aic" class="section level2 unnumbered">
<h2>Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)</h2>
<p>El <span class="math inline">\(AIC\)</span> se define como:</p>
<p><span class="math display">\[AIC = - 2 \times logLik + k \times n_{par},\]</span></p>
<p>donde <span class="math inline">\(logLik\)</span> corresponde al valor de log-verosimilitud del modelo para el vector de parámetros <span class="math inline">\(\hat{\Theta}\)</span>, <span class="math inline">\(k\)</span> es un valor de penalización por el exceso de parámetros y <span class="math inline">\(n_{par}\)</span> corresponde al número de parámetros del modelo.</p>
<p>Se debe recordar siempre que:</p>
<ul>
<li>El mejor modelo es aquel que <span class="math inline">\(logLik\)</span> ↑.</li>
<li>El mejor modelo es aquel que <span class="math inline">\(AIC\)</span> ↓.</li>
</ul>
<p>Cuando el valor de penalización <span class="math inline">\(k=\log(n)\)</span> entonces el <span class="math inline">\(AIC\)</span> se llamada en <span class="math inline">\(BIC\)</span> o <span class="math inline">\(SBC\)</span> (Schwarz’s Bayesian criterion).</p>
</div>
<div id="funciones-loglik-y-aic" class="section level2 unnumbered">
<h2>Funciones <code>logLik</code> y <code>AIC</code></h2>
<p>La función <code>logLik</code> sirve para obtener el valor de log-verosimilitud de un modelo y la función <code>AIC</code> entrega el Akaike Information Criterion. La estructura de ambas funciones se muestra a continuación.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="selec.html#cb241-1"></a><span class="kw">logLik</span>(object)</span>
<span id="cb241-2"><a href="selec.html#cb241-2"></a><span class="kw">AIC</span>(object, <span class="dt">k=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="métodos" class="section level2 unnumbered">
<h2>Métodos</h2>
<p>Los métodos para realizar selcción de variables se pueden clasificar de la siguiente manera:</p>
<ol style="list-style-type: decimal">
<li>Todas las regresiones posibles.</li>
<li>Selección de variables.
<ul>
<li>Forward</li>
<li>Backward</li>
</ul></li>
</ol>
<p>A continuación una imagen ilustrativa para entender ambos métodos.</p>
<div class="figure" style="text-align: center"><span id="fig:selection01"></span>
<img src="images/forward_backward.png" alt="Ilustración de los métodos Forward y Backward." width="686" />
<p class="caption">
Figure 12.1: Ilustración de los métodos Forward y Backward.
</p>
</div>
<ul>
<li>Un término ingresa al modelo si su presencia disminuye el <span class="math inline">\(AIC\)</span>.</li>
<li>Un términa sale del modelo si su ausencia disminuye el <span class="math inline">\(AIC\)</span>.</li>
</ul>
</div>
<div id="función-stepaic" class="section level2 unnumbered">
<h2>Función <code>stepAIC</code></h2>
<p>La función <code>stepAIC</code> del paquete <strong>MASS</strong> <span class="citation">(Ripley <a href="#ref-R-MASS" role="doc-biblioref">2020</a>)</span> es útil para hacer selección de variables en un modelo de regresión. La estructura de la función se muestra a continuación.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="selec.html#cb242-1"></a><span class="kw">stepAIC</span>(object, scope, <span class="dt">scale =</span> <span class="dv">0</span>,</span>
<span id="cb242-2"><a href="selec.html#cb242-2"></a>        <span class="dt">direction =</span> <span class="kw">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;backward&quot;</span>, <span class="st">&quot;forward&quot;</span>),</span>
<span id="cb242-3"><a href="selec.html#cb242-3"></a>        <span class="dt">trace =</span> <span class="dv">1</span>, <span class="dt">keep =</span> <span class="ot">NULL</span>, <span class="dt">steps =</span> <span class="dv">1000</span>, <span class="dt">use.start =</span> <span class="ot">FALSE</span>,</span>
<span id="cb242-4"><a href="selec.html#cb242-4"></a>        <span class="dt">k =</span> <span class="dv">2</span>, ...)</span></code></pre></div>
<p>Algunos de los argumentos son:</p>
<ul>
<li><code>object</code>: un objeto con un modelo.</li>
<li><code>scope</code>: fórmula(s) con los límites de búsqueda.</li>
<li><code>direction</code>: los posibles valores son <code>both</code>, <code>backward</code>, <code>forward</code>.</li>
<li><code>trace</code>: valor lógico para indicar si se desea ver el paso a paso de la selección.</li>
<li><code>k</code>: valor de penalidad, por defecto es 2.</li>
</ul>
<div id="ejemplo-35" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>En este ejemplo se busca encontrar un modelo de regresion lineal que explique la variable respuesta <span class="math inline">\(y\)</span> en función de las covariables <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_{11}\)</span>, los datos provienen del ejercicio 9.5 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>.</p>
<p>A continuación se muestra el encabezado de la base de datos y la definición de las variables.</p>
<div class="figure" style="text-align: center"><span id="fig:selection02"></span>
<img src="images/tableb3.PNG" alt="Ilustración de los métodos Forward y Backward." width="786" />
<p class="caption">
Figure 12.2: Ilustración de los métodos Forward y Backward.
</p>
</div>
<p><strong>Nota</strong>: Type of transmission (1=automatic, 0=manual).</p>
<p>Antes de iniciar es necesario revisar si hay <code>NA's</code> y eliminarlos.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="selec.html#cb243-1"></a><span class="kw">library</span>(MPV)  <span class="co"># Aqui estan los datos</span></span>
<span id="cb243-2"><a href="selec.html#cb243-2"></a>table.b3[<span class="dv">22</span><span class="op">:</span><span class="dv">26</span>, ] <span class="co"># Can you see the missing values?</span></span></code></pre></div>
<pre><code>##        y    x1  x2  x3  x4   x5 x6 x7    x8   x9  x10 x11
## 22 21.47 360.0 180 290 8.4 2.45  2  3 214.2 76.3 4250   1
## 23 16.59 400.0 185  NA 7.6 3.08  4  3 196.0 73.0 3850   1
## 24 31.90  96.9  75  83 9.0 4.30  2  5 165.2 61.8 2275   0
## 25 29.40 140.0  86  NA 8.0 2.92  2  4 176.4 65.4 2150   0
## 26 13.27 460.0 223 366 8.0 3.00  4  3 228.0 79.8 5430   1</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="selec.html#cb245-1"></a>datos &lt;-<span class="st"> </span>table.b3[<span class="op">-</span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">25</span>), ]</span></code></pre></div>
<p>El objeto <code>datos</code> tiene la base de datos sin las líneas con <code>NA</code>, lo mismo se hubiese podido realizar usando la función <code>na.omit</code>.</p>
<p>A continuación se muestran los diagramas de dispersión para las variables de la base de datos.</p>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<p><img src="Regresion_con_R_files/figure-html/selection03-1.png" width="960" /></p>
</div>
<div id="aplicación-del-método-backward" class="section level3 unnumbered">
<h3>Aplicación del método <strong>backward</strong></h3>
<p>Vamos a crear un modelo <em>saturado</em>, es decir, el modelo mayor a considerar.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="selec.html#cb249-1"></a>full.model &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>datos)</span>
<span id="cb249-2"><a href="selec.html#cb249-2"></a><span class="kw">summary</span>(full.model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ ., data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3441 -1.6711 -0.4486  1.4906  5.2508 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 17.339838  30.355375   0.571   0.5749  
## x1          -0.075588   0.056347  -1.341   0.1964  
## x2          -0.069163   0.087791  -0.788   0.4411  
## x3           0.115117   0.088113   1.306   0.2078  
## x4           1.494737   3.101464   0.482   0.6357  
## x5           5.843495   3.148438   1.856   0.0799 .
## x6           0.317583   1.288967   0.246   0.8082  
## x7          -3.205390   3.109185  -1.031   0.3162  
## x8           0.180811   0.130301   1.388   0.1822  
## x9          -0.397945   0.323456  -1.230   0.2344  
## x10         -0.005115   0.005896  -0.868   0.3971  
## x11          0.638483   3.021680   0.211   0.8350  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.227 on 18 degrees of freedom
## Multiple R-squared:  0.8355, Adjusted R-squared:  0.7349 
## F-statistic:  8.31 on 11 and 18 DF,  p-value: 5.231e-05</code></pre>
<p>De la tabla anterior se puede pensar en que hay un efecto de <span style="color:red">enmascaramiento</span> entre las variables ya que ninguna parece significativa marginalmente.</p>
<p>Se usa la función <code>stepAIC</code> y se elije <code>trace=TRUE</code> para obtener detalles del proceso de selección.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="selec.html#cb251-1"></a><span class="kw">library</span>(MASS)  <span class="co"># Para poder usar la funcion stepAIC</span></span>
<span id="cb251-2"><a href="selec.html#cb251-2"></a>modback &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(full.model, <span class="dt">trace=</span><span class="ot">TRUE</span>, <span class="dt">direction=</span><span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=78.96
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## 
##        Df Sum of Sq    RSS    AIC
## - x11   1     0.465 187.87 77.036
## - x6    1     0.632 188.03 77.063
## - x4    1     2.418 189.82 77.346
## - x2    1     6.462 193.86 77.979
## - x10   1     7.836 195.24 78.190
## - x7    1    11.065 198.47 78.683
## &lt;none&gt;              187.40 78.962
## - x9    1    15.758 203.16 79.384
## - x3    1    17.770 205.17 79.679
## - x1    1    18.736 206.14 79.820
## - x8    1    20.047 207.45 80.011
## - x5    1    35.864 223.26 82.215
## 
## Step:  AIC=77.04
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x6    1     0.536 188.40 75.121
## - x4    1     2.363 190.23 75.411
## - x2    1     6.642 194.51 76.078
## - x10   1     7.985 195.85 76.285
## &lt;none&gt;              187.87 77.036
## - x7    1    14.124 201.99 77.211
## - x9    1    16.914 204.78 77.622
## - x3    1    17.815 205.68 77.754
## - x1    1    18.280 206.15 77.822
## - x8    1    20.301 208.17 78.114
## - x5    1    36.370 224.24 80.345
## 
## Step:  AIC=75.12
## y ~ x1 + x2 + x3 + x4 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x4    1     3.451 191.85 73.666
## - x2    1     6.932 195.33 74.205
## - x10   1     9.351 197.75 74.574
## &lt;none&gt;              188.40 75.121
## - x7    1    14.473 202.87 75.342
## - x3    1    17.802 206.20 75.830
## - x9    1    18.146 206.55 75.880
## - x1    1    18.780 207.18 75.972
## - x8    1    21.244 209.65 76.326
## - x5    1    39.332 227.73 78.809
## 
## Step:  AIC=73.67
## y ~ x1 + x2 + x3 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x2    1    10.780 202.63 73.306
## - x7    1    11.113 202.97 73.355
## &lt;none&gt;              191.85 73.666
## - x10   1    14.988 206.84 73.923
## - x1    1    16.602 208.46 74.156
## - x9    1    18.072 209.92 74.366
## - x3    1    21.314 213.17 74.826
## - x8    1    28.835 220.69 75.867
## - x5    1    40.323 232.18 77.389
## 
## Step:  AIC=73.31
## y ~ x1 + x3 + x5 + x7 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x7    1    10.457 213.09 72.815
## - x3    1    10.595 213.23 72.835
## - x1    1    11.998 214.63 73.032
## - x9    1    12.643 215.28 73.122
## - x10   1    13.887 216.52 73.295
## &lt;none&gt;              202.63 73.306
## - x8    1    27.665 230.30 75.145
## - x5    1    30.191 232.82 75.472
## 
## Step:  AIC=72.82
## y ~ x1 + x3 + x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x3    1    4.8720 217.96 71.494
## - x9    1    5.2049 218.29 71.539
## - x1    1    5.3212 218.41 71.555
## &lt;none&gt;              213.09 72.815
## - x10   1   18.3677 231.46 73.296
## - x5    1   23.3458 236.44 73.934
## - x8    1   26.0316 239.12 74.273
## 
## Step:  AIC=71.49
## y ~ x1 + x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x1    1     0.765 218.73 69.599
## - x9    1     5.863 223.82 70.290
## &lt;none&gt;              217.96 71.494
## - x10   1    20.291 238.25 72.164
## - x5    1    23.020 240.98 72.506
## - x8    1    31.634 249.59 73.559
## 
## Step:  AIC=69.6
## y ~ x5 + x8 + x9 + x10
## 
##        Df Sum of Sq    RSS    AIC
## - x9    1     5.097 223.82 68.290
## &lt;none&gt;              218.73 69.599
## - x5    1    40.404 259.13 72.684
## - x8    1    57.407 276.13 74.591
## - x10   1   135.105 353.83 82.029
## 
## Step:  AIC=68.29
## y ~ x5 + x8 + x10
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              223.82 68.290
## - x5    1    36.314 260.14 70.800
## - x8    1    52.960 276.78 72.661
## - x10   1   194.838 418.66 85.076</code></pre>
<p>Para obtener un resumen del proceso se usa:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="selec.html#cb253-1"></a>modback<span class="op">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## 
## Final Model:
## y ~ x5 + x8 + x10
## 
## 
##    Step Df   Deviance Resid. Df Resid. Dev      AIC
## 1                            18   187.4007 78.96155
## 2 - x11  1  0.4648362        19   187.8655 77.03587
## 3  - x6  1  0.5356445        20   188.4012 75.12128
## 4  - x4  1  3.4514854        21   191.8526 73.66591
## 5  - x2  1 10.7796848        22   202.6323 73.30587
## 6  - x7  1 10.4571693        23   213.0895 72.81545
## 7  - x3  1  4.8720101        24   217.9615 71.49363
## 8  - x1  1  0.7654631        25   218.7270 69.59881
## 9  - x9  1  5.0970905        26   223.8241 68.28989</code></pre>
<p>Para ver la tabla de resultados del modelo <code>modback</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="selec.html#cb255-1"></a><span class="kw">summary</span>(modback)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x5 + x8 + x10, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6101 -1.9868 -0.6613  2.0369  5.8811 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.590404  11.771925   0.390   0.6998    
## x5           2.597240   1.264562   2.054   0.0502 .  
## x8           0.217814   0.087817   2.480   0.0199 *  
## x10         -0.009485   0.001994  -4.757 6.38e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.934 on 26 degrees of freedom
## Multiple R-squared:  0.8035, Adjusted R-squared:  0.7808 
## F-statistic: 35.44 on 3 and 26 DF,  p-value: 2.462e-09</code></pre>
</div>
<div id="aplicación-del-método-forward" class="section level3 unnumbered">
<h3>Aplicación del método <strong>forward</strong></h3>
<p>Para aplicar este metodo se debe crear un modelo vacío (<code>empty.model</code>) del cual iniciará el proceso. Es necesario definir un punto final de búsqueda, ese punto es una fórmula que en este caso llamaremos <code>horizonte</code>. A continuación el codigo.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="selec.html#cb257-1"></a>empty.model &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span>datos)</span>
<span id="cb257-2"><a href="selec.html#cb257-2"></a>horizonte &lt;-<span class="st"> </span><span class="kw">formula</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x4 <span class="op">+</span><span class="st"> </span>x5 <span class="op">+</span><span class="st"> </span>x6 <span class="op">+</span><span class="st"> </span>x7 <span class="op">+</span><span class="st"> </span>x8 <span class="op">+</span><span class="st"> </span>x9 <span class="op">+</span><span class="st"> </span>x10 <span class="op">+</span><span class="st"> </span>x11)</span></code></pre></div>
<p>Se usa la función <code>stepAIC</code> y se elije <code>trace=FALSE</code> para que NO se muestren los detalles del proceso de selección.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="selec.html#cb258-1"></a>modforw &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(empty.model, <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>, <span class="dt">scope=</span>horizonte)</span>
<span id="cb258-2"><a href="selec.html#cb258-2"></a>modforw<span class="op">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ 1
## 
## Final Model:
## y ~ x1 + x4
## 
## 
##   Step Df  Deviance Resid. Df Resid. Dev       AIC
## 1                          29  1139.1050 111.10402
## 2 + x1  1 866.49528        28   272.6097  70.20532
## 3 + x4  1  18.57161        27   254.0381  70.08861</code></pre>
<p>Para ver la tabla de resultados del modelo <code>modforw</code>.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="selec.html#cb260-1"></a><span class="kw">summary</span>(modforw)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x4, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.5011 -2.1243 -0.3884  1.9964  6.9582 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.179421  18.787955   0.382    0.705    
## x1          -0.044479   0.005225  -8.513 3.98e-09 ***
## x4           3.077228   2.190294   1.405    0.171    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.067 on 27 degrees of freedom
## Multiple R-squared:  0.777,  Adjusted R-squared:  0.7605 
## F-statistic: 47.03 on 2 and 27 DF,  p-value: 1.594e-09</code></pre>
<p>Como la variable <span class="math inline">\(x_4\)</span> no es significativa, entonces se puede <span style="color:red">refinar</span> o actualizar el modelo <code>modforw</code> sacando <span class="math inline">\(x_4\)</span>, esto se puede realizar fácilmente por medio de la función <code>update</code> así:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="selec.html#cb262-1"></a>modforw &lt;-<span class="st"> </span><span class="kw">update</span>(modforw, y <span class="op">~</span><span class="st"> </span>x1)</span>
<span id="cb262-2"><a href="selec.html#cb262-2"></a><span class="kw">summary</span>(modforw)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.6063 -2.0276 -0.0457  1.4531  7.0213 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 33.490010   1.535476  21.811  &lt; 2e-16 ***
## x1          -0.047026   0.004985  -9.434 3.43e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.12 on 28 degrees of freedom
## Multiple R-squared:  0.7607, Adjusted R-squared:  0.7521 
## F-statistic:    89 on 1 and 28 DF,  p-value: 3.429e-10</code></pre>
<p>En este <a href="https://www.researchgate.net/post/Why_stepAIC_gives_a_model_with_insignificant_variables_in_the_summarymodel2">enlace</a> usted podrá encontrar la respuesta que le dieron a Audrey al preguntar “Why stepAIC gives a model with insignificant variables?”.</p>
</div>
<div id="aplicación-del-método-both" class="section level3 unnumbered">
<h3>Aplicación del método <strong>both</strong></h3>
<p>Para aplicar este método se debe crear un modelo vacío del cual iniciará el proceso. Es necesario definir un punto final de búsqueda, ese punto es una <code>formula</code> que en este caso llamaremos <code>horizonte</code>. A continuación el código.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="selec.html#cb264-1"></a>modboth &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(empty.model, <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">direction=</span><span class="st">&quot;both&quot;</span>, <span class="dt">scope=</span>horizonte)</span>
<span id="cb264-2"><a href="selec.html#cb264-2"></a>modboth<span class="op">$</span>anova</span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ 1
## 
## Final Model:
## y ~ x1 + x4
## 
## 
##   Step Df  Deviance Resid. Df Resid. Dev       AIC
## 1                          29  1139.1050 111.10402
## 2 + x1  1 866.49528        28   272.6097  70.20532
## 3 + x4  1  18.57161        27   254.0381  70.08861</code></pre>
<p>El modelo <code>modboth</code> y <code>modforw</code> son el mismo.</p>
<p>A continuación vamos a realizar una comparación de los modelos obtenidos.</p>
<div id="comparando-r2_adj" class="section level4 unnumbered">
<h4>Comparando <span class="math inline">\(R^2_{Adj}\)</span></h4>
<p>Para extraer el <span class="math inline">\(R^2_{Adj}\)</span> de la tabla de resultados se usa:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="selec.html#cb266-1"></a><span class="kw">summary</span>(modback)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.7808368</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="selec.html#cb268-1"></a><span class="kw">summary</span>(modforw)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.7521337</code></pre>
</div>
<div id="comparando-hatsigma" class="section level4 unnumbered">
<h4>Comparando <span class="math inline">\(\hat{\sigma}\)</span></h4>
<p>Para extraer el <span class="math inline">\(\hat{\sigma}\)</span> de la tabla de resultados se usa:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="selec.html#cb270-1"></a><span class="kw">summary</span>(modback)<span class="op">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 2.934045</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="selec.html#cb272-1"></a><span class="kw">summary</span>(modforw)<span class="op">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 3.120266</code></pre>
</div>
<div id="comparando-los-residuales" class="section level4 unnumbered">
<h4>Comparando los residuales</h4>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="selec.html#cb274-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb274-2"><a href="selec.html#cb274-2"></a><span class="kw">plot</span>(modback, <span class="dt">main=</span><span class="st">&quot;Backward&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">which=</span><span class="dv">1</span>)</span>
<span id="cb274-3"><a href="selec.html#cb274-3"></a><span class="kw">plot</span>(modforw, <span class="dt">main=</span><span class="st">&quot;Forward&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/selection04-1.png" width="768" /></p>
</div>
</div>
<div id="ejercicios" class="section level3 unnumbered">
<h3>Ejercicios</h3>
<ol style="list-style-type: decimal">
<li>¿Qué patrón observa en los gráficos?</li>
<li>Para cada uno de los dos modelos incluya términos cuadráticos con el objetivo de explicar ese patrón cuadrático no explicado y mostrado en los gráficos de residuales anteriores.</li>
</ol>
</div>
</div>
<div id="funciones-addterm-y-dropterm" class="section level2 unnumbered">
<h2>Funciones <code>addterm</code> y <code>dropterm</code></h2>
<p>Estas dos funciones pertenecen al paquete <strong>MASS</strong> <span class="citation">(Ripley <a href="#ref-R-MASS" role="doc-biblioref">2020</a>)</span> y son útiles para agregar/quitar 1 variable con respecto al modelo ingresado. A continuación la estructura de las funciones.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="selec.html#cb275-1"></a><span class="kw">addterm</span>(object, ...)</span>
<span id="cb275-2"><a href="selec.html#cb275-2"></a><span class="kw">dropterm</span> (object, ...)</span></code></pre></div>
<div id="ejemplo-36" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Usando datos anteriores ajuste un modelo para explicar <code>y</code> en función de <code>x2</code> y <code>x5</code>, luego use <code>addterm</code> para determinar cual de las variables <code>x1</code>, <code>x4</code> y <code>x6</code> se debería ingresar.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="selec.html#cb276-1"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x5, <span class="dt">data=</span>datos)</span>
<span id="cb276-2"><a href="selec.html#cb276-2"></a>maximo &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x4 <span class="op">+</span><span class="st"> </span>x5 <span class="op">+</span><span class="st"> </span>x6)</span>
<span id="cb276-3"><a href="selec.html#cb276-3"></a><span class="kw">addterm</span>(mod1, <span class="dt">scope=</span>maximo)</span></code></pre></div>
<pre><code>## Single term additions
## 
## Model:
## y ~ x2 + x5
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;              353.19 79.974
## x1      1    88.511 264.67 73.319
## x3      1    47.296 305.89 77.661
## x4      1    19.915 333.27 80.233
## x6      1    19.452 333.73 80.274</code></pre>
<p>De la salida anterior se ve que ingresar <code>x1</code> mejoraría el modelo porque lo llevaría de un <span class="math inline">\(AIC=79.974\)</span> a uno con <span class="math inline">\(AIC=73.319\)</span>.</p>
</div>
</div>
<div id="paquete-olsrr" class="section level2 unnumbered">
<h2>Paquete <strong>olsrr</strong></h2>
<p>El paquete <strong>olsrr</strong> creado por <span class="citation">Hebbali (<a href="#ref-R-olsrr" role="doc-biblioref">2020</a>)</span> contiene varias funciones útiles para modelación, en particular se destaca la función <code>ols_step_all_possible</code> que se puede utilizar para obtener todas las regresiones posibles.</p>
<p>Si un modelo tiene inicialmente <span class="math inline">\(k\)</span> variables cuantitativas entonces se pueden construir <span class="math inline">\(2^k\)</span> modelos diferentes con subconjuntos de las variables originales. A continuación un ejemplo de cómo crece el número de todas las regresiones posibles en función del número <span class="math inline">\(k\)</span> de covariables.</p>
<pre><code>##       k num_de_regresiones
## [1,]  2                  4
## [2,]  4                 16
## [3,]  8                256
## [4,] 16              65536
## [5,] 32         4294967296</code></pre>
<div id="ejemplo-37" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>En este ejemplo vamos a usar la base de datos <code>mtcars</code> para crear todas las regresiones posibles para explicar <code>mpg</code> en función de las variables <code>disp</code>, <code>hp</code>, <code>wt</code>, <code>qsec</code>, a continuación una parte de la base de datos.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="selec.html#cb279-1"></a><span class="kw">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>A continuación el código para ajustar el modelo saturado y luego crear todas las regresiones posibles.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="selec.html#cb281-1"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec, <span class="dt">data=</span>mtcars)</span>
<span id="cb281-2"><a href="selec.html#cb281-2"></a></span>
<span id="cb281-3"><a href="selec.html#cb281-3"></a><span class="kw">library</span>(olsrr)</span>
<span id="cb281-4"><a href="selec.html#cb281-4"></a>res &lt;-<span class="st"> </span><span class="kw">ols_step_all_possible</span>(model)</span>
<span id="cb281-5"><a href="selec.html#cb281-5"></a>res</span></code></pre></div>
<pre><code>##    Index N      Predictors  R-Square Adj. R-Square Mallow&#39;s Cp
## 3      1 1              wt 0.7528328     0.7445939   12.480939
## 1      2 1            disp 0.7183433     0.7089548   18.129607
## 2      3 1              hp 0.6024373     0.5891853   37.112642
## 4      4 1            qsec 0.1752963     0.1478062  107.069616
## 8      5 2           hp wt 0.8267855     0.8148396    2.369005
## 10     6 2         wt qsec 0.8264161     0.8144448    2.429492
## 6      7 2         disp wt 0.7809306     0.7658223    9.879096
## 5      8 2         disp hp 0.7482402     0.7308774   15.233115
## 7      9 2       disp qsec 0.7215598     0.7023571   19.602810
## 9     10 2         hp qsec 0.6368769     0.6118339   33.472150
## 14    11 3      hp wt qsec 0.8347678     0.8170643    3.061665
## 11    12 3      disp hp wt 0.8268361     0.8082829    4.360702
## 13    13 3    disp wt qsec 0.8264170     0.8078189    4.429343
## 12    14 3    disp hp qsec 0.7541953     0.7278591   16.257790
## 15    15 4 disp hp wt qsec 0.8351443     0.8107212    5.000000</code></pre>
<p>Los resultados anteriores se pueden ver de forma gráfica así:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="selec.html#cb283-1"></a><span class="kw">plot</span>(res)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/selection05-1.png" width="672" /><img src="Regresion_con_R_files/figure-html/selection05-2.png" width="672" /></p>
<p>Se le recomienda al lector explorar las viñetas del paquete <a href="https://cran.r-project.org/web/packages/olsrr/index.html">olsrr</a> para conocer todas las bondades del paquete.</p>
</div>
</div>
<div id="paquete-mixlm" class="section level2 unnumbered">
<h2>Paquete <strong>mixlm</strong></h2>
<p>El paquete <strong>mixlm</strong> creado por <span class="citation">Liland (<a href="#ref-R-mixlm" role="doc-biblioref">2019</a>)</span> contiene un buen número de funciones para modelación. Algunas de las funciones a destacar son <code>forward</code>, <code>backward</code>, <code>stepWise</code>.</p>

<div class="rmdwarning">
Este paquete contiene otras funciones <code>lm</code> y <code>glm</code> que se pueden confundir con las funciones <code>lm</code> y <code>glm</code> del paquete <strong>stats</strong>. Por esta razón el usuario debe tener cuidado de usar la apropiada, en estos casos se recomienda usar <code>stats::lm(y ~ x)</code> o <code>mixlm::lm(y ~ x)</code> para obligar a R a que use la que el usuario desea.
</div>

<div id="ejemplo-38" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>En este ejemplo se retoman los datos del ejercicio 9.5 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>. En este ejemplo se busca encontrar un modelo de regresion lineal que explique la variable respuesta <span class="math inline">\(y\)</span> en función de las covariables <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_{11}\)</span>, usando el modelo backward y que todas las variables sean significativas a un nivel del 4%.</p>
<p>Para realizar lo solicitado se usa el siguiente código:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="selec.html#cb284-1"></a><span class="kw">library</span>(MPV) <span class="co"># Aqui estan los datos</span></span>
<span id="cb284-2"><a href="selec.html#cb284-2"></a>datos &lt;-<span class="st"> </span>table.b3[<span class="op">-</span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">25</span>), ] <span class="co"># Eliminando 2 observaciones con NA</span></span>
<span id="cb284-3"><a href="selec.html#cb284-3"></a>modelo &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x4 <span class="op">+</span><span class="st"> </span>x5 <span class="op">+</span><span class="st"> </span>x6 <span class="op">+</span><span class="st"> </span>x7 <span class="op">+</span><span class="st"> </span>x8 <span class="op">+</span><span class="st"> </span>x9 <span class="op">+</span><span class="st"> </span>x10 <span class="op">+</span><span class="st"> </span>x11,</span>
<span id="cb284-4"><a href="selec.html#cb284-4"></a>             <span class="dt">data=</span>datos)</span>
<span id="cb284-5"><a href="selec.html#cb284-5"></a></span>
<span id="cb284-6"><a href="selec.html#cb284-6"></a><span class="kw">library</span>(mixlm)</span>
<span id="cb284-7"><a href="selec.html#cb284-7"></a><span class="kw">backward</span>(modelo, <span class="dt">alpha=</span><span class="fl">0.04</span>)</span></code></pre></div>
<pre><code>## Backward elimination, alpha-to-remove: 0.04
## 
## Full model: y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11
## &lt;environment: 0x000000003b2af598&gt;
## 
##     Step    RSS    AIC  R2pred       Cp F value  Pr(&gt;F)  
## x11    1 187.87 77.036 0.41925 10.04465  0.0446 0.83503  
## x6     2 188.40 75.121 0.51334  8.09610  0.0542 0.81844  
## x4     3 191.85 73.666 0.53495  6.42762  0.3664 0.55178  
## x2     4 202.63 73.306 0.54991  5.46301  1.1799 0.28968  
## x7     5 213.09 72.815 0.61766  4.46743  1.1353 0.29819  
## x3     6 217.96 71.494 0.63898  2.93539  0.5259 0.47566  
## x1     7 218.73 69.599 0.66089  1.00892  0.0843 0.77406  
## x9     8 223.82 68.290 0.73638 -0.50150  0.5826 0.45244  
## x5     9 260.14 70.800 0.70705  0.98652  4.2184 0.05017 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ x8 + x10, data = datos)
## 
## Coefficients:
## (Intercept)           x8          x10  
##    16.23496      0.21234     -0.01022</code></pre>
<p>De la salida anterior vemos que el modelo final es <code>y ~ x8 + x10</code>. Si comparamos este modelo con el obtenido al usar la función <code>stepAIC</code>, vemos que se eliminó la variable <code>x5</code> ya que su valor-P era 5.02%, superior al límite definido aquí del 4%.</p>
</div>
</div>
<div id="paquete-leaps" class="section level2 unnumbered">
<h2>Paquete <strong>leaps</strong></h2>
<p>El paquete <strong>leaps</strong> creado por <span class="citation">Fortran code by Alan Miller (<a href="#ref-R-leaps" role="doc-biblioref">2020</a>)</span> está basado en <a href="https://es.wikipedia.org/wiki/Fortran">Fortran</a> y es útil cuando nos interese encontrar subconjuntos de covariables para optimizar las características de un modelo.</p>
<p>La función <code>regsubsets</code> realiza una búsqueda exhaustiva de los mejores subconjuntos de variables <span class="math inline">\(x\)</span> para explicar <span class="math inline">\(y\)</span>. La búsqueda utiliza un algoritmo eficiente de ramificación y unión.</p>
<p>La estructura de la función es la siguiente:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="selec.html#cb287-1"></a><span class="kw">regsubsets</span>(x, data, nbest, nvmax, ...)</span></code></pre></div>
<p>Algunos de los parámetros más usuados en la función son:</p>
<ul>
<li><code>x</code>: fórmula usual.</li>
<li><code>data</code>: marco de datos.</li>
<li><code>nbest</code>: número de subconjuntos de cada tamaño a guardar.</li>
<li><code>nvmax</code>: máximo número de subconjuntos a evaluar.</li>
</ul>
<div id="ejemplo-39" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>En este ejemplo vamos a usar la base de datos <code>mtcars</code> para encontrar los <strong>dos</strong> mejores modelos con 1, 2, 3 y 4 covariables para explicar <code>mpg</code> en función de las variables <code>disp</code>, <code>hp</code>, <code>wt</code>, <code>qsec</code>.</p>
<p>Para hacer la búsqueda usamos el siguiente código. <code>nbest=2</code> porque queremos los mejores <strong>dos</strong> modelos con cada número de covariables posible.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="selec.html#cb288-1"></a><span class="kw">library</span>(leaps)</span>
<span id="cb288-2"><a href="selec.html#cb288-2"></a>model_subset &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec, </span>
<span id="cb288-3"><a href="selec.html#cb288-3"></a>                           <span class="dt">data=</span>mtcars, <span class="dt">nbest=</span><span class="dv">2</span>, <span class="dt">nvmax=</span><span class="dv">13</span>)</span></code></pre></div>
<p>El <code>model_subset</code> es un objeto de la clase <code>regsubsets</code> y es posible usar la función S3 <code>summary</code> para objetos de esa clase. A continuación los elementos que componen <code>summary</code>.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="selec.html#cb289-1"></a><span class="kw">names</span>(<span class="kw">summary</span>(model_subset))</span></code></pre></div>
<pre><code>## [1] &quot;which&quot;  &quot;rsq&quot;    &quot;rss&quot;    &quot;adjr2&quot;  &quot;cp&quot;     &quot;bic&quot;    &quot;outmat&quot; &quot;obj&quot;</code></pre>
<p>El primer elemento del <code>summary</code> se obtiene así:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="selec.html#cb291-1"></a><span class="kw">summary</span>(model_subset)<span class="op">$</span>which</span></code></pre></div>
<pre><code>##   (Intercept)  disp    hp    wt  qsec
## 1        TRUE FALSE FALSE  TRUE FALSE
## 1        TRUE  TRUE FALSE FALSE FALSE
## 2        TRUE FALSE  TRUE  TRUE FALSE
## 2        TRUE FALSE FALSE  TRUE  TRUE
## 3        TRUE FALSE  TRUE  TRUE  TRUE
## 3        TRUE  TRUE  TRUE  TRUE FALSE
## 4        TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>De las dos primeras líneas de la salida anterior se observa que los dos mejores modelos con <strong>una</strong> sola covariable son <code>mpg ~ wt</code> y <code>mpg ~ disp</code>. De forma similar, los dos mejores modelos con <strong>dos</strong> covariables son <code>mpg ~ hp + wt</code> y <code>mpg ~ wt + qsec</code>. De forma análoga se interpretan las líneas de la salida anterior.</p>
<p>Es posible mostrar gráficamente los resultados anteriores usando el método S3 <code>plot</code> para objetos de la clase <code>regsubsets</code>. A continuación la estructura de la función <code>plot</code>. El parámetro <code>scale</code> nos permite explorar los mejores modelos para cada uno de los cuatro criterios <span class="math inline">\(BIC\)</span>, <span class="math inline">\(C_p\)</span>, <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="selec.html#cb293-1"></a><span class="kw">plot</span>(x, <span class="dt">labels=</span>obj<span class="op">$</span>xnames, <span class="dt">main=</span><span class="ot">NULL</span>, </span>
<span id="cb293-2"><a href="selec.html#cb293-2"></a>     <span class="dt">scale=</span><span class="kw">c</span>(<span class="st">&quot;bic&quot;</span>, <span class="st">&quot;Cp&quot;</span>, <span class="st">&quot;adjr2&quot;</span>, <span class="st">&quot;r2&quot;</span>),</span>
<span id="cb293-3"><a href="selec.html#cb293-3"></a>     <span class="dt">col=</span><span class="kw">gray</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="dt">length =</span> <span class="dv">10</span>)),...)</span></code></pre></div>
<p>A continuación el código para mostrar gráficamente los mejores modelos usando el criterio <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(BIC\)</span>.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="selec.html#cb294-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb294-2"><a href="selec.html#cb294-2"></a><span class="kw">plot</span>(model_subset, <span class="dt">scale=</span><span class="st">&quot;adjr2&quot;</span>, <span class="dt">main=</span><span class="kw">expression</span>(R[Adj]<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb294-3"><a href="selec.html#cb294-3"></a><span class="kw">plot</span>(model_subset, <span class="dt">scale=</span><span class="st">&quot;bic&quot;</span>, <span class="dt">main=</span><span class="st">&quot;BIC&quot;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/selection06-1.png" width="960" /></p>
<p>De la figura de la izquierda vemos que:</p>
<ul>
<li>El modelo con mayor <span class="math inline">\(R^2_{adj}\)</span> es <code>mpg ~ hp + wt + qsec</code>.</li>
<li>El modelo <code>mpg ~ hp + wt</code> tiene igual <span class="math inline">\(R^2_{adj}\)</span> que <code>mpg ~ wt + qsec</code>.</li>
<li>El mejor modelo con una sola covariable es <code>mpg ~ wt</code>.</li>
</ul>
<p>La figura de la derecha se puede analizar de forma análoga.</p>
<p>Para obtener los valores exacto de <span class="math inline">\(R^2_{adj}\)</span> y <span class="math inline">\(BIC\)</span> mostrados en la figura anterior se usa el siguiente código.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="selec.html#cb295-1"></a><span class="kw">summary</span>(model_subset)<span class="op">$</span>adjr2</span></code></pre></div>
<pre><code>## [1] 0.7445939 0.7089548 0.8148396 0.8144448 0.8170643 0.8082829 0.8107212</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="selec.html#cb297-1"></a><span class="kw">summary</span>(model_subset)<span class="op">$</span>bic</span></code></pre></div>
<pre><code>## [1] -37.79462 -33.61466 -45.70597 -45.63781 -43.74996 -42.24960 -40.35723</code></pre>
<p>Para encontrar el modelo con el mejor <span class="math inline">\(BIC\)</span> se puede usar lo siguiente:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="selec.html#cb299-1"></a><span class="kw">which</span>(<span class="kw">summary</span>(model_subset)<span class="op">$</span>bic <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(<span class="kw">summary</span>(model_subset)<span class="op">$</span>bic))</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Para determinar la estructura del <span style="color:orange">modelo 3</span> identificado en la salida anterior usamos:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="selec.html#cb301-1"></a><span class="kw">summary</span>(model_subset)<span class="op">$</span>which[<span class="dv">3</span>, ]</span></code></pre></div>
<pre><code>## (Intercept)        disp          hp          wt        qsec 
##        TRUE       FALSE        TRUE        TRUE       FALSE</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-leaps">
<p>Fortran code by Alan Miller, Thomas Lumley based on. 2020. <em>Leaps: Regression Subset Selection</em>. <a href="https://CRAN.R-project.org/package=leaps">https://CRAN.R-project.org/package=leaps</a>.</p>
</div>
<div id="ref-R-olsrr">
<p>Hebbali, Aravind. 2020. <em>Olsrr: Tools for Building Ols Regression Models</em>. <a href="https://CRAN.R-project.org/package=olsrr">https://CRAN.R-project.org/package=olsrr</a>.</p>
</div>
<div id="ref-R-mixlm">
<p>Liland, Kristian Hovde. 2019. <em>Mixlm: Mixed Model Anova and Statistics for Education</em>. <a href="https://CRAN.R-project.org/package=mixlm">https://CRAN.R-project.org/package=mixlm</a>.</p>
</div>
<div id="ref-R-MASS">
<p>Ripley, Brian. 2020. <em>MASS: Support Functions and Datasets for Venables and Ripley’s Mass</em>. <a href="https://CRAN.R-project.org/package=MASS">https://CRAN.R-project.org/package=MASS</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-poli.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="feature-selec.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_regresion/edit/master/12-selecvar.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
