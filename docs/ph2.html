<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Pruebas de hipótesis parte II | Modelos de Regresión con R</title>
  <meta name="description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Pruebas de hipótesis parte II | Modelos de Regresión con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="github-repo" content="fhernanb/libro_regresion" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Pruebas de hipótesis parte II | Modelos de Regresión con R" />
  
  <meta name="twitter:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Freddy Hernández" />
<meta name="author" content="Olga Usuga" />
<meta name="author" content="Mauricio Mazo" />


<meta name="date" content="2024-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ph1.html"/>
<link rel="next" href="diag1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos de Regresión con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>1</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#modelo-estadístico"><i class="fa fa-check"></i>Modelo estadístico</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#función-lm"><i class="fa fa-check"></i>Función <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#clase-lm"><i class="fa fa-check"></i>Clase <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#mínimos-cuadrados-ponderados"><i class="fa fa-check"></i>Mínimos cuadrados ponderados</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#apéndice"><i class="fa fa-check"></i>Apéndice</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-mínimos-cuadrados"><i class="fa fa-check"></i>Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Estimación por máxima verosimilitud</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>2</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#modelo-estadístico-1"><i class="fa fa-check"></i>Modelo estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predict.html"><a href="predict.html"><i class="fa fa-check"></i><b>3</b> Predicción</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#función-predict"><i class="fa fa-check"></i>Función <code>predict</code></a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-respuesta-media-eyx_0"><i class="fa fa-check"></i>Intervalo de confianza para la respuesta media <span class="math inline">\(E(Y|x_0)\)</span></a></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-predicción-de-nuevas-observaciones"><i class="fa fa-check"></i>Intervalo de confianza para la predicción de nuevas observaciones</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simul.html"><a href="simul.html"><i class="fa fa-check"></i><b>4</b> Simulación</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#preguntas-sobre-simulación-en-stackoverflow"><i class="fa fa-check"></i>Preguntas sobre simulación en StackOverFlow</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#simulando-datos-de-un-modelo-lineal"><i class="fa fa-check"></i>Simulando datos de un modelo lineal</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#función-simulate"><i class="fa fa-check"></i>Función <code>simulate</code></a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#otras-herramientas-para-simular"><i class="fa fa-check"></i>Otras herramientas para simular</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#videos-sugeridos"><i class="fa fa-check"></i>Videos sugeridos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ic.html"><a href="ic.html"><i class="fa fa-check"></i><b>5</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint"><i class="fa fa-check"></i>Función <code>confint</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint_sigma2"><i class="fa fa-check"></i>Función <code>confint_sigma2</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="varcuali.html"><a href="varcuali.html"><i class="fa fa-check"></i><b>6</b> Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#es-posible-incluir-variables-cualitativas"><i class="fa fa-check"></i>¿Es posible incluir variables cualitativas?</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#variable-indicadora-dummy-ficticia-o-binaria"><i class="fa fa-check"></i>Variable indicadora, dummy, ficticia o binaria</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#creando-variables-indicadoras"><i class="fa fa-check"></i>Creando variables indicadoras</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-10"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#modelos-con-variables-cualitativas"><i class="fa fa-check"></i>Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-11"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#significancia-de-variables-cualitativas"><i class="fa fa-check"></i>Significancia de variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-13"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ph1.html"><a href="ph1.html"><i class="fa fa-check"></i><b>7</b> Pruebas de hipótesis parte I</a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#pruebas-sobre-los-coeficientes-beta"><i class="fa fa-check"></i>Pruebas sobre los coeficientes <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-summary-cuando-beta_j0-0"><i class="fa fa-check"></i>Función <code>summary</code> cuando <span class="math inline">\(\beta_{j0} = 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-beta_test-cuando-beta_k0-neq-0"><i class="fa fa-check"></i>Función <code>beta_test</code> cuando <span class="math inline">\(\beta_{k0} \neq 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ph2.html"><a href="ph2.html"><i class="fa fa-check"></i><b>8</b> Pruebas de hipótesis parte II</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-sobre-todos-los-coeficientes"><i class="fa fa-check"></i>Prueba sobre todos los coeficientes</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-17"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-para-comparar-modelos-anidados"><i class="fa fa-check"></i>Prueba para comparar modelos anidados</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#función-anova"><i class="fa fa-check"></i>Función <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-20"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#summary-versus-anova"><i class="fa fa-check"></i><code>summary</code> versus <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-21"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i>Prueba razón de verosimilitud</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-22"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#comparaciones-múltiples"><i class="fa fa-check"></i>Comparaciones múltiples</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-23"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diag1.html"><a href="diag1.html"><i class="fa fa-check"></i><b>9</b> Diagnósticos parte I</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#supuestos"><i class="fa fa-check"></i>Supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#residuales"><i class="fa fa-check"></i>Residuales</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-normalidad-de-los-errores"><i class="fa fa-check"></i>Chequeando normalidad de los errores</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-con-media-cero"><i class="fa fa-check"></i>Chequeando si errores con media cero</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-los-errores-tiene-varianza-constante"><i class="fa fa-check"></i>Chequeando si los errores tiene varianza constante</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-no-están-correlacionados"><i class="fa fa-check"></i>Chequeando si errores no están correlacionados</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-cumpliendo-los-supuestos"><i class="fa fa-check"></i>Ejemplo cumpliendo los supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-violando-los-supuestos"><i class="fa fa-check"></i>Ejemplo violando los supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-violando-los-supuestos-1"><i class="fa fa-check"></i>Ejemplo violando los supuestos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#gráficos-de-residuales-usando-car"><i class="fa fa-check"></i>Gráficos de residuales usando car</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-25"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#prueba-de-falta-de-ajuste"><i class="fa fa-check"></i>Prueba de falta de ajuste</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-1-1"><i class="fa fa-check"></i>Ejemplo 1</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-2-1"><i class="fa fa-check"></i>Ejemplo 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diag2.html"><a href="diag2.html"><i class="fa fa-check"></i><b>10</b> Diagnósticos parte II</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#matriz-sombrero-o-hat"><i class="fa fa-check"></i>Matriz sombrero o hat</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#qué-es-extrapolación-oculta"><i class="fa fa-check"></i>¿Qué es extrapolación oculta?</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-26"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#reto-para-el-lector"><i class="fa fa-check"></i>Reto para el lector</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#punto-atípico-outlier-y-punto-influyente"><i class="fa fa-check"></i>Punto atípico (outlier) y punto influyente</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#prueba-de-bonferroni-para-detectar-outliers"><i class="fa fa-check"></i>Prueba de Bonferroni para detectar outliers</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-27"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#distancia-de-cook"><i class="fa fa-check"></i>Distancia de Cook</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-28"><i class="fa fa-check"></i>Ejemplo:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dffits"><i class="fa fa-check"></i>DFFITS</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dfbetas"><i class="fa fa-check"></i>DFBETAS</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-29"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#estadística-press-y-r2-de-predicción"><i class="fa fa-check"></i>Estadística PRESS y <span class="math inline">\(R^2\)</span> de predicción</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-30"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#valores-de-corte-para-diagnósticos"><i class="fa fa-check"></i>Valores de corte para diagnósticos</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="homo.html"><a href="homo.html"><i class="fa fa-check"></i><b>11</b> Pruebas de Homocedasticidad</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#breusch-pagan-test"><i class="fa fa-check"></i>Breusch-Pagan Test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-31"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#white-test"><i class="fa fa-check"></i>White test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#score-test-for-nonconstant-error-variance"><i class="fa fa-check"></i>Score test for nonconstant error variance</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#goldfeld-quandt-test"><i class="fa fa-check"></i>Goldfeld-Quandt Test</a></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#harrison-mccabe-test"><i class="fa fa-check"></i>Harrison-McCabe test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="indep.html"><a href="indep.html"><i class="fa fa-check"></i><b>12</b> Pruebas de independencia de los errores</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#durbin-watson-test"><i class="fa fa-check"></i>Durbin-Watson test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#breusch-godfrey-test"><i class="fa fa-check"></i>Breusch-Godfrey Test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-35"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod_poli.html"><a href="mod_poli.html"><i class="fa fa-check"></i><b>13</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-de-una-o-varias-variables"><i class="fa fa-check"></i>Modelos polinomiales de una o varias variables</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#funciones-i-y-poly"><i class="fa fa-check"></i>Funciones <code>I()</code> y <code>poly()</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-con-splines"><i class="fa fa-check"></i>Modelos polinomiales con splines</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-37"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-bs"><i class="fa fa-check"></i>Función <code>bs</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-38"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-39"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-lowess"><i class="fa fa-check"></i>Función <code>lowess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-40"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-loess"><i class="fa fa-check"></i>Función <code>loess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-41"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#optimización-con-superficies-de-respuesta"><i class="fa fa-check"></i>Optimización con superficies de respuesta</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-nlminb"><i class="fa fa-check"></i>Función <code>nlminb</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-42"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#polinomios-ortogonales"><i class="fa fa-check"></i>Polinomios ortogonales</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="selec.html"><a href="selec.html"><i class="fa fa-check"></i><b>14</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#akaike-information-criterion-aic"><i class="fa fa-check"></i>Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-loglik-y-aic"><i class="fa fa-check"></i>Funciones <code>logLik</code> y <code>AIC</code></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#métodos"><i class="fa fa-check"></i>Métodos</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#función-stepaic"><i class="fa fa-check"></i>Función <code>stepAIC</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-43"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-backward"><i class="fa fa-check"></i>Aplicación del método <strong>backward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-forward"><i class="fa fa-check"></i>Aplicación del método <strong>forward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-both"><i class="fa fa-check"></i>Aplicación del método <strong>both</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-addterm-y-dropterm"><i class="fa fa-check"></i>Funciones <code>addterm</code> y <code>dropterm</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-44"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-olsrr"><i class="fa fa-check"></i>Paquete <strong>olsrr</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-45"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-mixlm"><i class="fa fa-check"></i>Paquete <strong>mixlm</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-46"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-leaps"><i class="fa fa-check"></i>Paquete <strong>leaps</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-47"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="feature_selec.html"><a href="feature_selec.html"><i class="fa fa-check"></i><b>15</b> Feature selection</a>
<ul>
<li class="chapter" data-level="" data-path="feature_selec.html"><a href="feature_selec.html#feature-selection-with-the-caret-r-package"><i class="fa fa-check"></i>Feature Selection with the Caret R Package</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="multicoli.html"><a href="multicoli.html"><i class="fa fa-check"></i><b>16</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#qué-es-multicolinealidad"><i class="fa fa-check"></i>¿Qué es multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#multicolinealidad-inducida"><i class="fa fa-check"></i>Multicolinealidad inducida</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#cómo-identificar-la-multicolinealidad"><i class="fa fa-check"></i>¿Cómo identificar la multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#matriz-de-correlaciones"><i class="fa fa-check"></i>Matriz de correlaciones</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-48"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#factor-de-inflación-de-la-varianza-vif"><i class="fa fa-check"></i>Factor de Inflación de la Varianza (VIF)</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-49"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="algmat.html"><a href="algmat.html"><i class="fa fa-check"></i><b>17</b> Algebra matricial con R</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#matrices"><i class="fa fa-check"></i>Matrices</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-50"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#operaciones-básicas-sobre-una-matriz"><i class="fa fa-check"></i>Operaciones básicas sobre una matriz</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#rango-de-una-matriz"><i class="fa fa-check"></i>Rango de una matriz</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-51"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-52"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="WilRog.html"><a href="WilRog.html"><i class="fa fa-check"></i><b>18</b> Notación de Wilkinson y Rogers</a>
<ul>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#qué-es-una-fórmula-en-r"><i class="fa fa-check"></i>¿Qué es una fórmula en R?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#para-qué-sirve-la-notación-de-wilkinson-y-rogers"><i class="fa fa-check"></i>¿Para qué sirve la notación de Wilkinson y Rogers?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#paquete-formula-de-r"><i class="fa fa-check"></i>Paquete Formula de R</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="xy.html"><a href="xy.html"><i class="fa fa-check"></i><b>19</b> ¿Cómo obtener la matriz <span class="math inline">\(\boldsymbol{X}\)</span> y el vector <span class="math inline">\(\boldsymbol{y}\)</span>?</a>
<ul>
<li class="chapter" data-level="" data-path="xy.html"><a href="xy.html#ejemplo-53"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="important.html"><a href="important.html"><i class="fa fa-check"></i><b>20</b> Otros aspectos importantes</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#qué-otras-funciones-hay-en-r-para-ajustar-un-modelo"><i class="fa fa-check"></i>¿Qué otras funciones hay en R para ajustar un modelo?</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#ejemplo-54"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#modelos-de-regresión-con-grandes-conjuntos-de-datos"><i class="fa fa-check"></i>Modelos de regresión con grandes conjuntos de datos</a></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#fast-lm-in-r"><i class="fa fa-check"></i>Fast <code>lm</code> in R</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pasos.html"><a href="pasos.html"><i class="fa fa-check"></i><b>21</b> Pasos para construir modelos</a>
<ul>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-construir-un-modelo"><i class="fa fa-check"></i>Pasos para construir UN modelo</a></li>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-comparar-varios-modelos"><i class="fa fa-check"></i>Pasos para comparar varios modelos</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="misspecification.html"><a href="misspecification.html"><i class="fa fa-check"></i><b>22</b> Mala especificación</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ph2" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Pruebas de hipótesis parte II<a href="ph2.html#ph2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En este capítulo se muestra como realizar pruebas de significancia en un modelo de regresión. Las pruebas aquí explicadas son las siguientes:</p>
<ul>
<li>Prueba sobre todos los coeficientes (prueba de significancia de la regresión).</li>
<li>Prueba para comparar modelos anidados (prueba parcial F).</li>
</ul>
<div id="prueba-sobre-todos-los-coeficientes" class="section level2 unnumbered hasAnchor">
<h2>Prueba sobre todos los coeficientes<a href="ph2.html#prueba-sobre-todos-los-coeficientes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Supongamos que tenemos un modelo de regresión múltiple como se muestra a continuación.</p>
<p><span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\
\mu_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \cdots + \beta_k x_{ki}, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
<p>Para este modelo nos podemos preguntar si <strong>alguna</strong> de las covariables aporta información al modelo o si <strong>ninguna</strong> aporta información al modelo. Esta duda se puede resumir simbólicamente por medio del siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_1=\beta_2=\ldots=\beta_k=0 \\
H_1 &amp;= \text{al menos uno de los} \, \beta_j\neq0 \, \text{con} \, j=1,2,\ldots,k,
\end{align}\]</span></p>
<p>La prueba para analizar las hipótesis anteriores se llama <strong>prueba de significancia de la regresión</strong>.</p>
<p>En todo modelo de regresión vamos a tener una variabilidad Total (<span class="math inline">\(SS_T\)</span>), una variabilidad explicada por el modelo de Regresión (<span class="math inline">\(SS_R\)</span>) y una variabilidad Residual (<span class="math inline">\(SS_{Res}\)</span>) que no logra ser explicada por el modelo, abajo una figura ilustrativa de las tres variabilidades.</p>
<p align="center">
<img src="images/ph_significancia_reg.png" width="500">
</p>
<p>En esta prueba la idea es determinar si la variabilidad explicada por la Regresión (<span class="math inline">\(SS_R\)</span>) es una parte considerable de la variabilidad Total (<span class="math inline">\(SS_T\)</span>) o no. Para realizar esta prueba se construye la tabla anova (analysis of variance) tal como se muestra a continuación.</p>
<p align="center">
<img src="images/tabla_ph_significancia_reg.png" width="600">
</p>
<p>Asumiendo <span class="math inline">\(H_0\)</span> verdadera, la distribución del estadístico <span class="math inline">\(F_0\)</span> es <span class="math inline">\(F_{k, n-k-1}\)</span>.</p>
<div id="ejemplo-16" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-16" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ilustración vamos a usar los datos del ejemplo sobre la resistencia de piezas soldadas en función de la edad de la soldadura. ¿Será que la variable edad si ayuda a explicar la resistencia?, ¿será que la variable edad es significativa para el modelo?</p>
<p align="center">
<img src="images/ilustracion_soldadura.png" width="400">
</p>
<p><strong>Solución</strong></p>
<p>En este problema nos interesa estudiar el siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_{edad}=0 \\
H_1 &amp;: \beta_{edad} \neq 0
\end{align}\]</span></p>
<p>Para responder esta pregunta vamos a aplicar la prueba de significancia de la regresión. Lo primero que se debe hacer es ajustar el modelo.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="ph2.html#cb100-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/fhernanb/datos/master/propelente&quot;</span></span>
<span id="cb100-2"><a href="ph2.html#cb100-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span>file, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb100-3"><a href="ph2.html#cb100-3" tabindex="-1"></a></span>
<span id="cb100-4"><a href="ph2.html#cb100-4" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data=</span>datos)</span></code></pre></div>
<p>Luego de ajustar el modelo debemos calcular los elementos de la tabla anova, para eso podemos usar la función <code>anova_table_lm</code> del paquete <strong>model</strong>. Para instalar el paquete <strong>model</strong> podemos usar el siguiente código.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="ph2.html#cb101-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;devtools&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb101-2"><a href="ph2.html#cb101-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;fhernanb/model&#39;</span>, <span class="at">force=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Luego de esto ya podemos usar la función <code>anova_table_lm</code> así:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="ph2.html#cb102-1" tabindex="-1"></a><span class="fu">library</span>(model)</span>
<span id="cb102-2"><a href="ph2.html#cb102-2" tabindex="-1"></a><span class="fu">anova_table_lm</span>(mod1)</span></code></pre></div>
<pre><code>## Anova Table
##             Sum Sq Df Mean Sq F value    Pr(&gt;F)    
## Regression 1527483  1 1527483  165.38 1.643e-10 ***
## Residuals   166255 18    9236                      
## Total      1693738 19                              
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De la tabla anterior se observa que el valor-P es muy pequeño por lo tanto hay evidencias para rechazar <span class="math inline">\(H_0: \beta_{edad}=0\)</span>, eso significa que la variable edad si ayuda a explicar la media de la variable respuesta.</p>
<p>Otra forma de aplicar la prueba de significancia de la regresión es usando la función <code>summary</code> la cual nos entrega una parte de la tabla anova anterior (no toda la tabla anova).</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="ph2.html#cb104-1" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Resistencia ~ Edad, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -215.98  -50.68   28.74   66.61  106.76 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2627.822     44.184   59.48  &lt; 2e-16 ***
## Edad         -37.154      2.889  -12.86 1.64e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 96.11 on 18 degrees of freedom
## Multiple R-squared:  0.9018, Adjusted R-squared:  0.8964 
## F-statistic: 165.4 on 1 and 18 DF,  p-value: 1.643e-10</code></pre>
<p>En la última línea de la salida anterior tenemos la información de la prueba de hipótesis sobre significancia de la regresión. El valor-P de esta prueba es 1.643e-10 y por lo tanto podemos rechazar <span class="math inline">\(H_0\)</span> a un nivel de significancia usual del 5%, eso significa que la variable edad si ayuda a explicar la resistencia.</p>
</div>
<div id="ejemplo-17" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-17" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ilustración vamos a usar los datos del ejemplo 3.1 del libro de <span class="citation">(<a href="#ref-mpv06">E. &amp;. V. Montgomery D. &amp; Peck 2006</a>)</span>. En el ejemplo 3.1 los autores ajustaron un modelo de regresión lineal múltiple para explicar el <strong>Tiempo</strong> necesario para que un trabajador haga el mantenimiento y surta una máquina dispensadora de refrescos en función de las variables <strong>Número de Cajas</strong> y <strong>Distancia</strong>.</p>
<p>¿Será que las variables <strong>Número de Cajas</strong> y <strong>Distancia</strong> son significativas en el modelo?</p>
<p align="center">
<img src="images/ilustracion_refrescos.png" width="600">
</p>
<p><strong>Solución</strong></p>
<p>En este problema nos interesa estudiar el siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_{cant}=\beta_{dis}=0 \\
H_1 &amp;= \text{al menos uno de los coefiencientes} \, \beta_{cant} \, \text{o} \, \beta_{dis} \, \text{es diferente de cero}
\end{align}\]</span></p>
<p>Para responder esta pregunta vamos a aplicar la prueba de significancia de la regresión. Lo primero que se debe hacer es ajustar el modelo.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="ph2.html#cb106-1" tabindex="-1"></a><span class="fu">require</span>(MPV)</span>
<span id="cb106-2"><a href="ph2.html#cb106-2" tabindex="-1"></a><span class="fu">colnames</span>(softdrink) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;tiempo&#39;</span>, <span class="st">&#39;cantidad&#39;</span>, <span class="st">&#39;distancia&#39;</span>)</span>
<span id="cb106-3"><a href="ph2.html#cb106-3" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tiempo <span class="sc">~</span> cantidad <span class="sc">+</span> distancia, <span class="at">data=</span>softdrink, <span class="at">x=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Luego de ajustar el modelo debemos calcular los elementos de la tabla anova, para eso usamos el siguiente código.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="ph2.html#cb107-1" tabindex="-1"></a><span class="fu">anova_table_lm</span>(mod2)</span></code></pre></div>
<pre><code>## Anova Table
##            Sum Sq Df Mean Sq F value    Pr(&gt;F)    
## Regression 5550.8  2 2775.41  261.24 4.687e-16 ***
## Residuals   233.7 22   10.62                      
## Total      5784.5 24                              
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De la tabla anterior se observa que el valor-P es muy pequeño por lo tanto hay evidencias para rechazar <span class="math inline">\(H_0: \beta_{cant}=\beta_{dis}=0\)</span>, eso significa que al menos una (o ambas) de las variables si ayudan a explicar la media de la variable respuesta.</p>
<p>Otra forma de aplicar la prueba de significancia de la regresión es usando la función <code>summary</code> la cual nos entrega una parte de la tabla anova anterior (no toda la tabla anova).</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="ph2.html#cb109-1" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = tiempo ~ cantidad + distancia, data = softdrink, 
##     x = TRUE)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.341231   1.096730   2.135 0.044170 *  
## cantidad    1.615907   0.170735   9.464 3.25e-09 ***
## distancia   0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
## Multiple R-squared:  0.9596, Adjusted R-squared:  0.9559 
## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16</code></pre>
<p>En la última línea de la salida anterior tenemos la información de la prueba de hipótesis sobre significancia de la regresión. El valor-P de esta prueba es 4.687e-16 y por lo tanto podemos rechazar <span class="math inline">\(H_0\)</span> a un nivel de significancia usual del 5%, eso significa que al menos una de las dos covariables del modelo es significativa para explicar el tiempo medio.</p>

<div class="rmdnote">
El no rechazar <span class="math inline">\(H_0: \beta_1 = \beta_2 = \ldots = \beta_k = 0\)</span> significa que ninguna de las variables aporta información para explicar la media de <span class="math inline">\(Y\)</span>. Lo que se debe hacer luego es buscar nuevas covariables que sean significativas.
</div>

<div class="rmdnote">
El rechazar <span class="math inline">\(H_0: \beta_1 = \beta_2 = \ldots = \beta_k = 0\)</span> significa que una, o dos, o tres, o cuatro, …, o que todas las <span class="math inline">\(k\)</span> covariables son significativas. Pero, ¿cómo saber cuales variables son significativas?
</div>
</div>
</div>
<div id="prueba-para-comparar-modelos-anidados" class="section level2 unnumbered hasAnchor">
<h2>Prueba para comparar modelos anidados<a href="ph2.html#prueba-para-comparar-modelos-anidados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Esta prueba se usa para comparar modelos que comparten una estructura anidada.</p>
<p>A continuación se muestran dos modelos (reducido y completo) anidados a manera de ilustración.</p>
<p>Modelo reducido
<span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\
\mu_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i}, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
<p>Modelo completo
<span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\
\mu_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i}, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
<p>La pregunta que surge aquí es: ¿vale la pena incluir las variables <span class="math inline">\(x_3\)</span> y <span class="math inline">\(x_4\)</span> simultáneamente al modelo reducido? ¿esas variables mejoran el modelo reducido? ¿será mejor el modelo reducido o el modelo completo?</p>
<p>Los interrogantes anteriores se pueden resumir simbólicamente así:</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_3=\beta_4=0 \\
H_1 &amp;= \text{al menos uno de los coefiencientes} \, \beta_{3} \, \text{o} \, \beta_{4} \, \text{es diferente de cero}
\end{align}\]</span></p>
<p>Para realizar esta prueba se usa el siguiente estadístico</p>
<p><span class="math display">\[
F_0 = \frac{\frac{SS_R(complete) - SS_R(reduced)}{p_1-p_0}}{MS_{Res}},
\]</span>
donde <span class="math inline">\(SS_R(complete)\)</span> es la suma de cuadrados de la regresión para el modelo completo, <span class="math inline">\(SS_R(reduced)\)</span> es la suma de cuadrados de la regresión para el modelo reducido, <span class="math inline">\(p_1\)</span> es el número de <span class="math inline">\(\beta\)</span>’s en el modelo completo, <span class="math inline">\(p_0\)</span> es el número de <span class="math inline">\(\beta\)</span>’s en el modelo reducido y <span class="math inline">\(MS_{Res}\)</span> es la estimación de <span class="math inline">\(\sigma^2\)</span> en el modelo completo. La distribución del estadístico <span class="math inline">\(F_0\)</span> es:</p>
<ul>
<li><span class="math inline">\(F_{p_1-p_0, n-p_1}\)</span> si <span class="math inline">\(H_0\)</span> es cierta.</li>
<li><span class="math inline">\(F_{p_1-p_0, n-p_1, \lambda}\)</span> si <span class="math inline">\(H_1\)</span> es cierta, siendo <span class="math inline">\(\lambda\)</span> el parámetro de no centralidad de una distribución F.</li>
</ul>
<p>Para conocer la expresión de <span class="math inline">\(\lambda\)</span> se recomienda revisar la página 90 de <span class="citation">(<a href="#ref-Montgomery12">D. C. Montgomery, Peck, and Vining 2012</a>)</span> y los comentarios al respecto.</p>
<div id="ejemplo-18" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-18" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando la base de datos <code>table.b4</code> del paquete <strong>MPV</strong> <span class="citation">(<a href="#ref-R-MPV"><strong>R-MPV?</strong></a>)</span>, queremos comparar dos modelos anidados:</p>
<ul>
<li>el modelo reducido con la fórmula <code>y ~ x1 + x2</code>,</li>
<li>y el modelo completo con la fórmula <code>y ~ x1 + x2 + x3 + x4</code>.</li>
</ul>
<p>¿Será que la inclusión simultánea de las variables <code>x3</code> y <code>x4</code> mejora el modelo para explicar la variable respuesta <code>y</code>? Use <span class="math inline">\(\alpha=0.03\)</span> para concluir.</p>
<p align="center">
<img src="images/blocks.jpg" width="200">
</p>
<p><strong>Solución</strong></p>
<p>Primero veamos los datos.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ph2.html#cb111-1" tabindex="-1"></a><span class="fu">require</span>(MPV)</span>
<span id="cb111-2"><a href="ph2.html#cb111-2" tabindex="-1"></a><span class="fu">data</span>(table.b4) </span>
<span id="cb111-3"><a href="ph2.html#cb111-3" tabindex="-1"></a><span class="fu">head</span>(table.b4, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      y     x1 x2    x3    x4 x5 x6 x7 x8 x9
## 1 29.5 5.0208  1 3.531 1.500  2  7  4 62  0
## 2 27.9 4.5429  1 2.275 1.175  1  6  3 40  0
## 3 25.9 4.5573  1 4.050 1.232  1  6  3 54  0
## 4 29.9 5.0597  1 4.455 1.121  1  6  3 42  0</code></pre>
<p>Ajustemos los dos modelos de interés.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="ph2.html#cb113-1" tabindex="-1"></a>redu_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>table.b4, <span class="at">x=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-2"><a href="ph2.html#cb113-2" tabindex="-1"></a>comp_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4, <span class="at">data=</span>table.b4, <span class="at">x=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>En este ejercicio nos interesa estudiar el siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_3 = \beta_4 = 0 \\
H_1 &amp;= \text{al menos uno de los coefiencientes} \, \beta_{3} \, \text{o} \, \beta_{4} \, \text{es diferente de cero}
\end{align}\]</span></p>
<p>Ahora construyamos el estadístico <span class="math inline">\(F_0\)</span>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="ph2.html#cb114-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">24</span> <span class="co"># numero de observaciones</span></span>
<span id="cb114-2"><a href="ph2.html#cb114-2" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># numero de betas en modelo reducido</span></span>
<span id="cb114-3"><a href="ph2.html#cb114-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># numero de betas en modelo completo</span></span>
<span id="cb114-4"><a href="ph2.html#cb114-4" tabindex="-1"></a></span>
<span id="cb114-5"><a href="ph2.html#cb114-5" tabindex="-1"></a>ssr_reduced  <span class="ot">&lt;-</span> <span class="fu">sum</span>(table.b4<span class="sc">$</span>y) <span class="sc">-</span> <span class="fu">sum</span>(redu_mod<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb114-6"><a href="ph2.html#cb114-6" tabindex="-1"></a>ssr_complete <span class="ot">&lt;-</span> <span class="fu">sum</span>(table.b4<span class="sc">$</span>y) <span class="sc">-</span> <span class="fu">sum</span>(comp_mod<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb114-7"><a href="ph2.html#cb114-7" tabindex="-1"></a>ms_res <span class="ot">&lt;-</span> <span class="fu">summary</span>(comp_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb114-8"><a href="ph2.html#cb114-8" tabindex="-1"></a>F0 <span class="ot">&lt;-</span> ((ssr_complete <span class="sc">-</span> ssr_reduced) <span class="sc">/</span> (p1<span class="sc">-</span>p0)) <span class="sc">/</span> ms_res</span>
<span id="cb114-9"><a href="ph2.html#cb114-9" tabindex="-1"></a>F0</span></code></pre></div>
<pre><code>## [1] 0.2831532</code></pre>
<p>Ahora vamos a calcular el parámetro de no centralidad <span class="math inline">\(\lambda\)</span>. Recuerde revisar la página 90 de <span class="citation">(<a href="#ref-Montgomery12">D. C. Montgomery, Peck, and Vining 2012</a>)</span> para conocer su expresión.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="ph2.html#cb116-1" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.3233333</span>, <span class="sc">-</span><span class="fl">0.2176622</span>), <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb116-2"><a href="ph2.html#cb116-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> comp_mod<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb116-3"><a href="ph2.html#cb116-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> comp_mod<span class="sc">$</span>x[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb116-4"><a href="ph2.html#cb116-4" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">t</span>(beta2) <span class="sc">%*%</span> <span class="fu">t</span>(x2)</span>
<span id="cb116-5"><a href="ph2.html#cb116-5" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">diag</span>(n) <span class="sc">-</span> x1 <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(x1) <span class="sc">%*%</span> x1) <span class="sc">%*%</span> <span class="fu">t</span>(x1)</span>
<span id="cb116-6"><a href="ph2.html#cb116-6" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> x2 <span class="sc">%*%</span> beta2</span>
<span id="cb116-7"><a href="ph2.html#cb116-7" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> (a1 <span class="sc">%*%</span> a2 <span class="sc">%*%</span> a3) <span class="sc">/</span> <span class="fu">summary</span>(comp_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb116-8"><a href="ph2.html#cb116-8" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.5663064</code></pre>
<p>Ahora vamos a calcular el valor-P de la prueba usando la distribución F no central y la distribució F (usual) así:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ph2.html#cb118-1" tabindex="-1"></a><span class="fu">pf</span>(<span class="at">q=</span>F0, <span class="at">df1=</span>p1<span class="sc">-</span>p0, <span class="at">df2=</span>n<span class="sc">-</span>p1, <span class="at">ncp=</span>lambda, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.8088857</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ph2.html#cb120-1" tabindex="-1"></a><span class="fu">pf</span>(<span class="at">q=</span>F0, <span class="at">df1=</span>p1<span class="sc">-</span>p0, <span class="at">df2=</span>n<span class="sc">-</span>p1, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.7565282</code></pre>
<p>Usando el último valor-P que es mayor que un nivel de significancia <span class="math inline">\(\alpha\)</span>, no hay evidencias para rechazar <span class="math inline">\(H_0: \beta_3 = \beta_4 = 0\)</span>, y por lo tanto podemos concluir que las variables <code>x3</code> y <code>x4</code> no mejoran el modelo.</p>
</div>
</div>
<div id="función-anova" class="section level2 unnumbered hasAnchor">
<h2>Función <code>anova</code><a href="ph2.html#función-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>anova</code> permite realizar pruebas de hipótesis como las mostradas en las secciones anteriores, en particular la función sirve para:</p>
<ul>
<li>comparar secuencialmente las variables de un modelo.</li>
<li>comparar modelos anidados.</li>
</ul>
<p>El método S3 <code>anova.lm</code> (o simplemente <code>anova</code>) tiene la estructura mostrada a continuación.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ph2.html#cb122-1" tabindex="-1"></a><span class="fu">anova</span>(object, test, <span class="at">scale=</span><span class="dv">0</span>)</span></code></pre></div>
<p>Los argumentos de esta función son:</p>
<ul>
<li><code>object</code>: un objeto de la clase <code>lm</code>.</li>
<li><code>test</code>: una cadena de caracteres indicando el tipo de prueba, <code>F</code>, <code>Chisq</code> o <code>Cp</code>, el valor por defecto es <code>F</code>.</li>
<li><code>scale</code>: valor de la estimación de <span class="math inline">\(\sigma^2\)</span>. Cuando es igual a cero se usa el estimador del modelo con más parámetros.</li>
</ul>

<div class="rmdnote">
<p>La función <code>anova</code> se puede aplicar a un solo modelo y el resultado será una prueba de hipótesis secuencial en las variables.</p>
La función <code>anova</code> se puede aplicar a varios modelos y el resultado será una comparación de modelos.
</div>
<p>A continuación se muestran dos ejemplos en los cuales se ilustra la utilidad de la función <code>anova</code>.</p>
<div id="ejemplo-19" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-19" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo se mostrará la segunda utilidad de la función <code>anova</code>. Para esto vamos a utilizar la base de datos <code>Cars93</code> del paquete <code>MASS</code>. El objetivo es construir un modelo para explicar la media del <code>Price</code> de los autos en función de las variables <code>Horsepower</code>, <code>Type</code> y <code>Weight</code>.</p>
<p align="center">
<img src="images/car.gif" width="200">
</p>
<p><strong>Solución</strong></p>
<p>La solución de este ejercicio tendrá dos partes, en la primera se construirán varios modelos, iniciando con uno sin covariables (<code>mod0</code>) hasta uno con todas las covariables (<code>mod3</code>). En la segunda parte se analizará el modelo con todas las covariables directamente.</p>
<p><strong>Primera parte</strong></p>
<p>A continuación el código para crear y comparar los modelos sin covariables y el modelo con solo <code>Horsepower</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="ph2.html#cb123-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb123-2"><a href="ph2.html#cb123-2" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>Cars93)</span>
<span id="cb123-3"><a href="ph2.html#cb123-3" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Horsepower, <span class="at">data=</span>Cars93)</span>
<span id="cb123-4"><a href="ph2.html#cb123-4" tabindex="-1"></a><span class="fu">anova</span>(mod0, mod1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Price ~ 1
## Model 2: Price ~ Horsepower
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     92 8584.0                                  
## 2     91 3250.9  1    5333.1 149.29 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De la salida anterior se tiene que el valor-P es &lt; 2.2e-16 y por lo tanto se concluye que la variable <code>Horsepower</code> mejora el modelo (la misma conclusión se pudo obtener del <code>summary</code>).</p>
<p>Ahora vamos a crear y comparar el modelo con sólo <code>Horsepower</code> con el modelo con <code>Horsepower</code> y <code>Type</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="ph2.html#cb125-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Horsepower <span class="sc">+</span> Type, <span class="at">data=</span>Cars93)</span>
<span id="cb125-2"><a href="ph2.html#cb125-2" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Price ~ Horsepower
## Model 2: Price ~ Horsepower + Type
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1     91 3250.9                              
## 2     86 2758.1  5    492.81 3.0733 0.01337 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De la salida anterior se tiene que el valor-P es 0.01337 y por lo tanto se concluye que el modelo <code>mod2</code> con dos covariables explica mejor la variable <code>Price</code>.</p>
<p>Ahora vamos a crear y comparar el modelo con <code>Horsepower</code> y <code>Type</code> con el modelo con las tres covariables.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="ph2.html#cb127-1" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Horsepower <span class="sc">+</span> Type <span class="sc">+</span> Weight, <span class="at">data=</span>Cars93)</span>
<span id="cb127-2"><a href="ph2.html#cb127-2" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Price ~ Horsepower + Type
## Model 2: Price ~ Horsepower + Type + Weight
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     86 2758.1                           
## 2     85 2751.3  1    6.7934 0.2099  0.648</code></pre>
<p>De esta última salida vemos que el valor-P es 0.648, esto indica que la inclusión de la variable <code>Weight</code> no mejora el modelo <code>mod2</code> (la misma conclusión se pudo obtener del <code>summary</code>).</p>
<p><strong>Segunda parte</strong></p>
<p>En esta segunda parte del ejemplo se usará la función <code>anova</code> directamente sobre el modelo completo <code>mod3</code>, a continuación los resultados.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="ph2.html#cb129-1" tabindex="-1"></a><span class="fu">anova</span>(mod3)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Price
##            Df Sum Sq Mean Sq  F value  Pr(&gt;F)    
## Horsepower  1 5333.1  5333.1 164.7661 &lt; 2e-16 ***
## Type        5  492.8    98.6   3.0451 0.01411 *  
## Weight      1    6.8     6.8   0.2099 0.64803    
## Residuals  85 2751.3    32.4                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>En la tabla anterior aparecen los resultados de una prueba de hipótesis secuencial a partir de la fórmula de <code>mod3</code>. La fórmula de <code>mod3</code> es <code>Price ~ Horsepower + Type + Weight</code>, por lo tanto en la primera línea de la tabla aparece la variable <code>Horsepower</code>, luego en la segunda aparece <code>Type</code> y así hasta la última variable <code>Weight</code>. El valor-P reportado en la primer línea es &lt; 2e-16, esto indica el modelo con <code>Horsepower</code> es mejor que el modelo sin covariables; el valor-P de la segunda línea es 0.01411, esto indica que es mejor un modelo con las covariables <code>Horsepower</code> y <code>Type</code>; por último el valor-P de la tercer línea es 0.64803, esto indica que la variable <code>Weight</code> no mejora el modelo, es decir, que es mejor un modelo con solo <code>Horsepower</code> y <code>Type</code>.</p>
</div>
<div id="ejemplo-20" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-20" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando la base de datos <code>table.b4</code> del paquete <strong>MPV</strong> <span class="citation">(<a href="#ref-R-MPV"><strong>R-MPV?</strong></a>)</span>, queremos comparar dos modelos anidados:</p>
<ul>
<li>el modelo reducido con la fórmula <code>y ~ x1 + x2</code>,</li>
<li>y el modelo completo con la fórmula <code>y ~ x1 + x2 + x3 + x4</code>.</li>
</ul>
<p>¿Será que la inclusión simultánea de las variables <code>x3</code> y <code>x4</code> mejora el modelo para explicar la variable respuesta <code>y</code>? Use <span class="math inline">\(\alpha=0.03\)</span> para concluir.</p>
<p align="center">
<img src="images/blocks.jpg" width="200">
</p>
<p><strong>Solución</strong></p>
<p>Para este ejemplo vamos a usar los datos que se muestran a continuación.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="ph2.html#cb131-1" tabindex="-1"></a><span class="fu">require</span>(MPV)</span>
<span id="cb131-2"><a href="ph2.html#cb131-2" tabindex="-1"></a><span class="fu">data</span>(table.b4) </span>
<span id="cb131-3"><a href="ph2.html#cb131-3" tabindex="-1"></a><span class="fu">head</span>(table.b4, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      y     x1 x2    x3    x4 x5 x6 x7 x8 x9
## 1 29.5 5.0208  1 3.531 1.500  2  7  4 62  0
## 2 27.9 4.5429  1 2.275 1.175  1  6  3 40  0
## 3 25.9 4.5573  1 4.050 1.232  1  6  3 54  0
## 4 29.9 5.0597  1 4.455 1.121  1  6  3 42  0</code></pre>
<p>Ahora vamos a ajustar ambos modelos usando el siguiente código.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="ph2.html#cb133-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>table.b4)</span>
<span id="cb133-2"><a href="ph2.html#cb133-2" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4, <span class="at">data=</span>table.b4)</span></code></pre></div>
<p>El objetivo en este ejercicio analizar el siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[H_0: \text{las variables x3 y x4 no mejoran el modelo},\]</span>
<span class="math display">\[H_A: \text{al menos una de ellas si mejora el modelo}\]</span></p>
<p>Para comparar los dos modelos usamos la siguiente instrucción.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="ph2.html#cb134-1" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2, <span class="at">test=</span><span class="st">&#39;F&#39;</span>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ x1 + x2
## Model 2: y ~ x1 + x2 + x3 + x4
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     21 163.71                           
## 2     19 158.98  2    4.7384 0.2832 0.7565</code></pre>
<p>De la salida anterior se observa que el valor-P de la prueba es de 0.7565, usando un nivel de significancia del 5%, se concluye que la inclusión de las variables <code>x3</code> y <code>x4</code> no mejoran el modelo.</p>
</div>
</div>
<div id="summary-versus-anova" class="section level2 unnumbered hasAnchor">
<h2><code>summary</code> versus <code>anova</code><a href="ph2.html#summary-versus-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>summary</code> permite evaluar el efecto de una variable asumiendo que las restantes variables siguen en el modelo, esto es llamado prueba de hipótesis marginal. Cuando se tiene una variable cualitativa (con <span class="math inline">\(k\)</span> niveles) dentro del modelo, ella aparecerá en la tabla del <code>summary</code> por medio de <span class="math inline">\(k-1\)</span> variables indicadoras y por lo tanto se tendrán <span class="math inline">\(k-1\)</span> valores-P asociados. Usar esos valores-P para decidir si una variable cualitativa es importante en el modelo puede ser engañoso, a continuación un ejemplo de esta situación.</p>
<div id="ejemplo-21" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-21" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El ejemplo aquí mostrado está basado en una <a href="https://stats.stackexchange.com/questions/115304/interpreting-output-from-anova-when-using-lm-as-input">pregunta</a> de StackOverFlow.</p>
<p>El ejemplo consiste en simular un conjunto de 30 valores de <span class="math inline">\(y \sim N(\mu, 1)\)</span>, donde las observaciones 1 a 10 tienen <span class="math inline">\(\mu=0\)</span>, las observaciones 11 a 20 tienen <span class="math inline">\(\mu=-0.5\)</span> y las restantes diez tienen <span class="math inline">\(\mu=0.5\)</span>. Para diferenciar las observaciones se tendrá la variable de agruación cualitativa <code>g</code> que contendrá las letras A, B y C diez veces cada una. El código para simular los datos se muestra a continuación.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="ph2.html#cb136-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8867</span>)  <span class="co"># this makes the example exactly reproducible</span></span>
<span id="cb136-2"><a href="ph2.html#cb136-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean=</span><span class="dv">0</span>,    <span class="at">sd=</span><span class="dv">1</span>),</span>
<span id="cb136-3"><a href="ph2.html#cb136-3" tabindex="-1"></a>       <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">sd=</span><span class="dv">1</span>),</span>
<span id="cb136-4"><a href="ph2.html#cb136-4" tabindex="-1"></a>       <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean=</span><span class="fl">0.5</span>,  <span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb136-5"><a href="ph2.html#cb136-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each=</span><span class="dv">10</span>)</span></code></pre></div>
<p>¿Será la variable cualitativa <code>g</code> significativa en un modelo de regresión?</p>
<p><strong>Solución</strong></p>
<p>Vamos a ajustar el modelo con fórmula <code>y ~ g</code> para estudiar el efecto de la agrupación <code>g</code> en la media de la variable respuesta <code>y</code>.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ph2.html#cb137-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> g)</span></code></pre></div>
<p>Obviamente esperamos concluir que la media de la variable <code>y</code> dependa de la variable de agrupación <code>g</code>. Para esto vamos a explorar el resultado con la función <code>summary</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="ph2.html#cb138-1" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ g)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.59080 -0.54685  0.04124  0.79890  2.56064 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -0.4440     0.3855  -1.152    0.260
## gB           -0.9016     0.5452  -1.654    0.110
## gC            0.6729     0.5452   1.234    0.228
## 
## Residual standard error: 1.219 on 27 degrees of freedom
## Multiple R-squared:  0.2372, Adjusted R-squared:  0.1807 
## F-statistic: 4.199 on 2 and 27 DF,  p-value: 0.02583</code></pre>
<p>De la salida anterior vemos que los efectos <code>gB</code> y <code>gC</code> tienen valores-P altos, superiores al usual 5%, y por lo tanto estaríamos tentados a decir que la variable <code>g</code> no tiene efecto sobre la media de <code>y</code>. El lector podría encontrar esto un poco desconcertante.</p>
<p>Vamos a realizar el análisis pero ahora con la función <code>anova</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="ph2.html#cb140-1" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## g          2 12.484  6.2418   4.199 0.02583 *
## Residuals 27 40.135  1.4865                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>En la fila donde aparece la variable <code>g</code> tenemos el resultado de la prueba de hipótesis</p>
<p><span class="math display">\[H_0: \text{la variable g no influye en la media de y},\]</span>
<span class="math display">\[H_A: \text{la variable g si influye en la media de y}\]</span></p>
<p>El valor-P de esta prueba es de 0.02583, esto indica que hay evidencias para rechazar <span class="math inline">\(H_0\)</span>, es decir, encontramos que la variable <code>g</code> si influye sobre la media de la variable <code>y</code>.</p>

<div class="rmdtip">
Cuando se quiera explorar el efecto de una variable cualitativa en un modelo es mejor usar la función <code>anova</code> que los resultados del <code>summary</code>.
</div>
</div>
</div>
<div id="prueba-razón-de-verosimilitud" class="section level2 unnumbered hasAnchor">
<h2>Prueba razón de verosimilitud<a href="ph2.html#prueba-razón-de-verosimilitud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Esta prueba evalúa la bondad de ajuste de dos modelos estadísticos competitivos en función de la razón de sus verosimilitudes, específicamente uno encontrado por maximización en todo el espacio de parámetros y otro encontrado después de imponer alguna restricción (<span class="math inline">\(H_0\)</span>).</p>
<p>El estadístico de la prueba razón de verosimilitud se muestra a continuación.</p>
<p><span class="math display">\[
\lambda = -2 \log \left[ \frac{L(\Theta_0)}{L(\Theta)} \right] = -2 \left[ l(\Theta_0)-l(\Theta) \right],
\]</span></p>
<p>donde <span class="math inline">\(L\)</span> representa el valor de la verosimilitud y <span class="math inline">\(l\)</span> el valor de log-verosimilitud. Bajo la hipótesis nula, <span class="math inline">\(\lambda \sim \chi^2_{k}\)</span> donde <span class="math inline">\(k\)</span> es la diferencia entre el número de parámetros de los modelos comparados.</p>
<div id="ejemplo-22" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-22" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando la base de datos <code>table.b4</code> del paquete <strong>MPV</strong> <span class="citation">(<a href="#ref-R-MPV"><strong>R-MPV?</strong></a>)</span>, queremos comparar dos modelos anidados:</p>
<ul>
<li>el modelo reducido con la fórmula <code>y ~ x1 + x2</code>,</li>
<li>y el modelo completo con la fórmula <code>y ~ x1 + x2 + x3 + x4</code>.</li>
</ul>
<p>¿Será que la inclusión simultánea de las variables <code>x3</code> y <code>x4</code> mejora el modelo para explicar la variable respuesta <code>y</code>? Use <span class="math inline">\(\alpha=0.03\)</span> para concluir.</p>
<p><strong>Solución</strong></p>
<p>Para este ejemplo vamos a usar los datos que se muestran a continuación.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ph2.html#cb142-1" tabindex="-1"></a><span class="fu">require</span>(MPV)</span>
<span id="cb142-2"><a href="ph2.html#cb142-2" tabindex="-1"></a><span class="fu">data</span>(table.b4) </span>
<span id="cb142-3"><a href="ph2.html#cb142-3" tabindex="-1"></a><span class="fu">head</span>(table.b4, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      y     x1 x2    x3    x4 x5 x6 x7 x8 x9
## 1 29.5 5.0208  1 3.531 1.500  2  7  4 62  0
## 2 27.9 4.5429  1 2.275 1.175  1  6  3 40  0
## 3 25.9 4.5573  1 4.050 1.232  1  6  3 54  0
## 4 29.9 5.0597  1 4.455 1.121  1  6  3 42  0</code></pre>
<p>Ahora vamos a ajustar ambos modelos usando el siguiente código.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="ph2.html#cb144-1" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>table.b4)</span>
<span id="cb144-2"><a href="ph2.html#cb144-2" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4, <span class="at">data=</span>table.b4)</span></code></pre></div>
<p>El objetivo en este ejercicio analizar el siguiente conjunto de hipótesis.</p>
<p><span class="math display">\[H_0: \text{las variables x3 y x4 no mejoran el modelo},\]</span>
<span class="math display">\[H_A: \text{al menos una de ellas si mejora el modelo}\]</span></p>
<p>Para aplicar la prueba razón de verosimilitud usamos el siguiente código. Los grados de libertad en esta prueba son 2 porque esa es la diferencia entre el número de parámetros de los modelos.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ph2.html#cb145-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod0) <span class="sc">-</span> <span class="fu">logLik</span>(mod1))</span>
<span id="cb145-2"><a href="ph2.html#cb145-2" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 0.7048811 (df=4)</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ph2.html#cb147-1" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q=</span>lambda, <span class="at">df=</span><span class="dv">2</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 0.7029704 (df=4)</code></pre>
<p>Como el valor-P es grande, no hay evidencias para rechazar <span class="math inline">\(H_0: \beta_3 = \beta_4 = 0\)</span>, y por lo tanto podemos concluir que las variables <code>x3</code> y <code>x4</code> no mejoran el modelo.</p>
</div>
</div>
<div id="comparaciones-múltiples" class="section level2 unnumbered hasAnchor">
<h2>Comparaciones múltiples<a href="ph2.html#comparaciones-múltiples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección se muestra como utilizar el paquete <strong>multcomp</strong> <span class="citation">(<a href="#ref-R-multcomp">Hothorn, Bretz, and Westfall 2023</a>)</span> que está basado en el libro “Multiple comparisons using R” <span class="citation">(<a href="#ref-bretz2010">Frank Bretz 2010</a>)</span> para estudiar pruebas de hipótesis múltiples.</p>
<div id="ejemplo-23" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="ph2.html#ejemplo-23" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Usando la base de datos <code>table.b4</code> del paquete <strong>MPV</strong> <span class="citation">(<a href="#ref-R-MPV"><strong>R-MPV?</strong></a>)</span>, queremos ajustar el siguiente modelo:</p>
<p><span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\
\mu_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i}, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
<p>¿Será que la inclusión simultánea de las variables <code>x3</code> y <code>x4</code> mejora el modelo para explicar la variable respuesta <code>y</code>? Use <span class="math inline">\(\alpha=0.03\)</span> para concluir.</p>
<p><strong>Solución</strong></p>
<p>Lo primero que debemos hacer es ajustar el modelo de interés.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ph2.html#cb149-1" tabindex="-1"></a><span class="fu">require</span>(MPV)</span>
<span id="cb149-2"><a href="ph2.html#cb149-2" tabindex="-1"></a><span class="fu">data</span>(table.b4) </span>
<span id="cb149-3"><a href="ph2.html#cb149-3" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4, <span class="at">data=</span>table.b4)</span>
<span id="cb149-4"><a href="ph2.html#cb149-4" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2          x3          x4 
##   9.8408825   2.4374996   6.4373377   0.3233333  -0.2176622</code></pre>
<p>En este ejemplo nos interesa estudiar las siguientes dos hipótesis simultáneamente (no individualmente).</p>
<p><span class="math display">\[\begin{align*}
H_0 &amp;: \beta_{3} = 0      &amp;  H_0 &amp;: \beta_{4} = 0 \\
H_A &amp;: \beta_{3} \neq 0   &amp;  H_A &amp;: \beta_{4} \neq 0
\end{align*}\]</span></p>
<p>Los dos conjuntos de hipótesis anteriores se pueden escribir matricialmente usando una matriz de constrate <span class="math inline">\(\boldsymbol{C}\)</span> que multiplica al vector de parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> y luego igualando es producto con el vector <span class="math inline">\(\boldsymbol{a}=(0, 0)^\top\)</span> que contiene lados derechos de las hipótesis anteriores.</p>
<p><span class="math display">\[
\boldsymbol{C} \boldsymbol{\beta} =
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
\beta_0 \\
\beta_1 \\
\beta_2 \\
\beta_3 \\
\beta_4 \\
\end{pmatrix} =
\begin{pmatrix}
\beta_3 \\
\beta_4
\end{pmatrix}
\]</span></p>
<p>Teniendo definida la matriz <span class="math inline">\(\boldsymbol{C}\)</span>, el vector <span class="math inline">\(\boldsymbol{a}\)</span> la prueba simultánea de las hipótesis se puede hacer de la siguiente manera.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ph2.html#cb151-1" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb151-2"><a href="ph2.html#cb151-2" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb151-3"><a href="ph2.html#cb151-3" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-4"><a href="ph2.html#cb151-4" tabindex="-1"></a>mult_test <span class="ot">&lt;-</span> <span class="fu">glht</span>(<span class="at">model=</span>mod, <span class="at">linfct=</span>C, <span class="at">alternative=</span><span class="st">&#39;two.sided&#39;</span>, <span class="at">rhs=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb151-5"><a href="ph2.html#cb151-5" tabindex="-1"></a><span class="fu">summary</span>(mult_test, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">&quot;single-step&quot;</span>))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = y ~ x1 + x2 + x3 + x4, data = table.b4)
## 
## Linear Hypotheses:
##        Estimate Std. Error t value Pr(&gt;|t|)
## 1 == 0   0.3233     0.4324   0.748    0.704
## 2 == 0  -0.2177     3.7475  -0.058    0.998
## (Adjusted p values reported -- single-step method)</code></pre>
<p>De la salida anterior se obtiene que los dos valores-P “ajustados” (ver sección 2.1.2 de <span class="citation">(<a href="#ref-bretz2010">Frank Bretz 2010</a>)</span>) son:</p>
<p><span class="math display">\[
q_1 = 0.704 \qquad q_2 = 0.998
\]</span></p>
<p>lo que significa que no hay evidencias para rechazar <span class="math inline">\(H_0 : \beta_{3} = 0\)</span> ni evidencias para rechazar <span class="math inline">\(H_0 : \beta_{4} = 0\)</span> porque ambos valores-P “ajustados” fueron mayores del nivel de significancia de 0.03. En otras palabras, ni <code>x3</code> ni <code>x4</code> aportan información para explicar la media de <code>y</code>.</p>

<div class="rmdwarning">
Si un valor-P “ajustado” es menor que el <span class="math inline">\(\alpha\)</span>, se rechaza su correspondiente hipótesis nula <span class="math inline">\(H_0\)</span>, pero si el valor-P “ajustado” es mayor que el <span class="math inline">\(\alpha\)</span>, no se rechaza <span class="math inline">\(H_0\)</span>. En una aplicación es posible que se rechacen todas/algunas/ninguna de las <span class="math inline">\(H_0\)</span>.
</div>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bretz2010" class="csl-entry">
Frank Bretz, Peter Westfall, Torsten Hothorn. 2010. <em>Multiple Comparisons Using r</em>. Chapman; Hall/CRC.
</div>
<div id="ref-R-multcomp" class="csl-entry">
Hothorn, Torsten, Frank Bretz, and Peter Westfall. 2023. <em>Multcomp: Simultaneous Inference in General Parametric Models</em>. <a href="http://multcomp.R-forge.R-project.org">http://multcomp.R-forge.R-project.org</a>.
</div>
<div id="ref-Montgomery12" class="csl-entry">
Montgomery, Douglas C., Elizabeth A. Peck, and Geoffrey G. Vining. 2012. <em>Introduction to Linear Regression Analysis (5th Ed.)</em>. Wiley &amp; Sons.
</div>
<div id="ref-mpv06" class="csl-entry">
Montgomery, E. &amp; Vining, D. &amp; Peck. 2006. <em>Introducción Al Análisis de Regresión Lineal</em>. 3ed ed. México: Cecsa.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ph1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diag1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_regresion/edit/master/08-ph2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
